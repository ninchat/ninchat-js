"use strict";
(function() {

var $global,$module;if(Error.stackTraceLimit=1/0,"undefined"!=typeof window?$global=window:"undefined"!=typeof self?$global=self:"undefined"!=typeof global?($global=global).require=require:$global=this,void 0===$global||void 0===$global.Array)throw new Error("no global object found");"undefined"!=typeof module&&($module=module);var $throwRuntimeError,$packages={},$idCounter=0,$keys=function(e){return e?Object.keys(e):[]},$flushConsole=function(){},$throwNilPointerError=function(){$throwRuntimeError("invalid memory address or nil pointer dereference")},$call=function(e,n,r){return e.apply(n,r)},$makeFunc=function(e){return function(){return $externalize(e(this,new($sliceType($jsObjectPtr))($global.Array.prototype.slice.call(arguments,[]))),$emptyInterface)}},$unused=function(e){},$mapArray=function(e,n){for(var r=new e.constructor(e.length),t=0;t<e.length;t++)r[t]=n(e[t]);return r},$methodVal=function(e,n){var r=e.$methodVals||{};e.$methodVals=r;var t=r[n];if(void 0!==t)return t;var i=e[n];return t=function(){$stackDepthOffset--;try{return i.apply(e,arguments)}finally{$stackDepthOffset++}},r[n]=t,t},$methodExpr=function(e,n){var r=e.prototype[n];return void 0===r.$expr&&(r.$expr=function(){$stackDepthOffset--;try{return e.wrapped&&(arguments[0]=new e(arguments[0])),Function.call.apply(r,arguments)}finally{$stackDepthOffset++}}),r.$expr},$ifaceMethodExprs={},$ifaceMethodExpr=function(e){var n=$ifaceMethodExprs["$"+e];return void 0===n&&(n=$ifaceMethodExprs["$"+e]=function(){$stackDepthOffset--;try{return Function.call.apply(arguments[0][e],arguments)}finally{$stackDepthOffset++}}),n},$subslice=function(e,n,r,t){void 0===r&&(r=e.$length),void 0===t&&(t=e.$capacity),(n<0||r<n||t<r||r>e.$capacity||t>e.$capacity)&&$throwRuntimeError("slice bounds out of range");var i=new e.constructor(e.$array);return i.$offset=e.$offset+n,i.$length=r-n,i.$capacity=t-n,i},$substring=function(e,n,r){return(n<0||r<n||r>e.length)&&$throwRuntimeError("slice bounds out of range"),e.substring(n,r)},$sliceToArray=function(e){return e.$array.constructor!==Array?e.$array.subarray(e.$offset,e.$offset+e.$length):e.$array.slice(e.$offset,e.$offset+e.$length)},$decodeRune=function(e,n){var r=e.charCodeAt(n);if(r<128)return[r,1];if(r!=r||r<192)return[65533,1];var t=e.charCodeAt(n+1);if(t!=t||t<128||192<=t)return[65533,1];if(r<224)return(a=(31&r)<<6|63&t)<=127?[65533,1]:[a,2];var i=e.charCodeAt(n+2);if(i!=i||i<128||192<=i)return[65533,1];if(r<240)return(a=(15&r)<<12|(63&t)<<6|63&i)<=2047?[65533,1]:55296<=a&&a<=57343?[65533,1]:[a,3];var a,o=e.charCodeAt(n+3);return o!=o||o<128||192<=o?[65533,1]:r<248?(a=(7&r)<<18|(63&t)<<12|(63&i)<<6|63&o)<=65535||1114111<a?[65533,1]:[a,4]:[65533,1]},$encodeRune=function(e){return(e<0||e>1114111||55296<=e&&e<=57343)&&(e=65533),e<=127?String.fromCharCode(e):e<=2047?String.fromCharCode(192|e>>6,128|63&e):e<=65535?String.fromCharCode(224|e>>12,128|e>>6&63,128|63&e):String.fromCharCode(240|e>>18,128|e>>12&63,128|e>>6&63,128|63&e)},$stringToBytes=function(e){for(var n=new Uint8Array(e.length),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n},$bytesToString=function(e){if(0===e.$length)return"";for(var n="",r=0;r<e.$length;r+=1e4)n+=String.fromCharCode.apply(void 0,e.$array.subarray(e.$offset+r,e.$offset+Math.min(e.$length,r+1e4)));return n},$stringToRunes=function(e){for(var n,r=new Int32Array(e.length),t=0,i=0;i<e.length;i+=n[1],t++)n=$decodeRune(e,i),r[t]=n[0];return r.subarray(0,t)},$runesToString=function(e){if(0===e.$length)return"";for(var n="",r=0;r<e.$length;r++)n+=$encodeRune(e.$array[e.$offset+r]);return n},$copyString=function(e,n){for(var r=Math.min(n.length,e.$length),t=0;t<r;t++)e.$array[e.$offset+t]=n.charCodeAt(t);return r},$copySlice=function(e,n){var r=Math.min(n.$length,e.$length);return $copyArray(e.$array,n.$array,e.$offset,n.$offset,r,e.constructor.elem),r},$copyArray=function(e,n,r,t,i,a){if(0!==i&&(e!==n||r!==t))if(n.subarray)e.set(n.subarray(t,t+i),r);else{switch(a.kind){case $kindArray:case $kindStruct:if(e===n&&r>t){for(var o=i-1;o>=0;o--)a.copy(e[r+o],n[t+o]);return}for(o=0;o<i;o++)a.copy(e[r+o],n[t+o]);return}if(e===n&&r>t)for(o=i-1;o>=0;o--)e[r+o]=n[t+o];else for(o=0;o<i;o++)e[r+o]=n[t+o]}},$clone=function(e,n){var r=n.zero();return n.copy(r,e),r},$pointerOfStructConversion=function(e,n){void 0===e.$proxies&&(e.$proxies={},e.$proxies[e.constructor.string]=e);var r=e.$proxies[n.string];if(void 0===r){for(var t={},i=0;i<n.elem.fields.length;i++)!function(n){t[n]={get:function(){return e[n]},set:function(r){e[n]=r}}}(n.elem.fields[i].prop);(r=Object.create(n.prototype,t)).$val=r,e.$proxies[n.string]=r,r.$proxies=e.$proxies}return r},$append=function(e){return $internalAppend(e,arguments,1,arguments.length-1)},$appendSlice=function(e,n){if(n.constructor===String){var r=$stringToBytes(n);return $internalAppend(e,r,0,r.length)}return $internalAppend(e,n.$array,n.$offset,n.$length)},$internalAppend=function(e,n,r,t){if(0===t)return e;var i=e.$array,a=e.$offset,o=e.$length+t,$=e.$capacity;if(o>$)if(a=0,$=Math.max(o,e.$capacity<1024?2*e.$capacity:Math.floor(5*e.$capacity/4)),e.$array.constructor===Array){(i=e.$array.slice(e.$offset,e.$offset+e.$length)).length=$;for(var c=e.constructor.elem.zero,u=e.$length;u<$;u++)i[u]=c()}else(i=new e.$array.constructor($)).set(e.$array.subarray(e.$offset,e.$offset+e.$length));$copyArray(i,n,a+e.$length,r,t,e.constructor.elem);var l=new e.constructor(i);return l.$offset=a,l.$length=o,l.$capacity=$,l},$equal=function(e,n,r){if(r===$jsObjectPtr)return e===n;switch(r.kind){case $kindComplex64:case $kindComplex128:return e.$real===n.$real&&e.$imag===n.$imag;case $kindInt64:case $kindUint64:return e.$high===n.$high&&e.$low===n.$low;case $kindArray:if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!$equal(e[t],n[t],r.elem))return!1;return!0;case $kindStruct:for(t=0;t<r.fields.length;t++){var i=r.fields[t];if(!$equal(e[i.prop],n[i.prop],i.typ))return!1}return!0;case $kindInterface:return $interfaceIsEqual(e,n);default:return e===n}},$interfaceIsEqual=function(e,n){return e===$ifaceNil||n===$ifaceNil?e===n:e.constructor===n.constructor&&(e.constructor===$jsObjectPtr?e.object===n.object:(e.constructor.comparable||$throwRuntimeError("comparing uncomparable type "+e.constructor.string),$equal(e.$val,n.$val,e.constructor)))},$min=Math.min,$mod=function(e,n){return e%n},$parseInt=parseInt,$parseFloat=function(e){return void 0!==e&&null!==e&&e.constructor===Number?e:parseFloat(e)},$froundBuf=new Float32Array(1),$fround=Math.fround||function(e){return $froundBuf[0]=e,$froundBuf[0]},$imul=Math.imul||function(e,n){var r=65535&e,t=65535&n;return r*t+((e>>>16&65535)*t+r*(n>>>16&65535)<<16>>>0)>>0},$floatKey=function(e){return e!=e?"NaN$"+ ++$idCounter:String(e)},$flatten64=function(e){return 4294967296*e.$high+e.$low},$shiftLeft64=function(e,n){return 0===n?e:n<32?new e.constructor(e.$high<<n|e.$low>>>32-n,e.$low<<n>>>0):n<64?new e.constructor(e.$low<<n-32,0):new e.constructor(0,0)},$shiftRightInt64=function(e,n){return 0===n?e:n<32?new e.constructor(e.$high>>n,(e.$low>>>n|e.$high<<32-n)>>>0):n<64?new e.constructor(e.$high>>31,e.$high>>n-32>>>0):e.$high<0?new e.constructor(-1,4294967295):new e.constructor(0,0)},$shiftRightUint64=function(e,n){return 0===n?e:n<32?new e.constructor(e.$high>>>n,(e.$low>>>n|e.$high<<32-n)>>>0):n<64?new e.constructor(0,e.$high>>>n-32):new e.constructor(0,0)},$mul64=function(e,n){var r=0,t=0;0!=(1&n.$low)&&(r=e.$high,t=e.$low);for(var i=1;i<32;i++)0!=(n.$low&1<<i)&&(r+=e.$high<<i|e.$low>>>32-i,t+=e.$low<<i>>>0);for(i=0;i<32;i++)0!=(n.$high&1<<i)&&(r+=e.$low<<i);return new e.constructor(r,t)},$div64=function(e,n,r){0===n.$high&&0===n.$low&&$throwRuntimeError("integer divide by zero");var t=1,i=1,a=e.$high,o=e.$low;a<0&&(t=-1,i=-1,a=-a,0!==o&&(a--,o=4294967296-o));var $=n.$high,c=n.$low;n.$high<0&&(t*=-1,$=-$,0!==c&&($--,c=4294967296-c));for(var u=0,l=0,s=0;$<2147483648&&(a>$||a===$&&o>c);)$=($<<1|c>>>31)>>>0,c=c<<1>>>0,s++;for(var f=0;f<=s;f++)u=u<<1|l>>>31,l=l<<1>>>0,(a>$||a===$&&o>=c)&&(a-=$,(o-=c)<0&&(a--,o+=4294967296),4294967296===++l&&(u++,l=0)),c=(c>>>1|$<<31)>>>0,$>>>=1;return r?new e.constructor(a*i,o*i):new e.constructor(u*t,l*t)},$divComplex=function(e,n){var r=e.$real===1/0||e.$real===-1/0||e.$imag===1/0||e.$imag===-1/0,t=n.$real===1/0||n.$real===-1/0||n.$imag===1/0||n.$imag===-1/0,i=!r&&(e.$real!=e.$real||e.$imag!=e.$imag),a=!t&&(n.$real!=n.$real||n.$imag!=n.$imag);if(i||a)return new e.constructor(NaN,NaN);if(r&&!t)return new e.constructor(1/0,1/0);if(!r&&t)return new e.constructor(0,0);if(0===n.$real&&0===n.$imag)return 0===e.$real&&0===e.$imag?new e.constructor(NaN,NaN):new e.constructor(1/0,1/0);if(Math.abs(n.$real)<=Math.abs(n.$imag)){var o=n.$real/n.$imag,$=n.$real*o+n.$imag;return new e.constructor((e.$real*o+e.$imag)/$,(e.$imag*o-e.$real)/$)}o=n.$imag/n.$real,$=n.$imag*o+n.$real;return new e.constructor((e.$imag*o+e.$real)/$,(e.$imag-e.$real*o)/$)},$kindBool=1,$kindInt=2,$kindInt8=3,$kindInt16=4,$kindInt32=5,$kindInt64=6,$kindUint=7,$kindUint8=8,$kindUint16=9,$kindUint32=10,$kindUint64=11,$kindUintptr=12,$kindFloat32=13,$kindFloat64=14,$kindComplex64=15,$kindComplex128=16,$kindArray=17,$kindChan=18,$kindFunc=19,$kindInterface=20,$kindMap=21,$kindPtr=22,$kindSlice=23,$kindString=24,$kindStruct=25,$kindUnsafePointer=26,$methodSynthesizers=[],$addMethodSynthesizer=function(e){null!==$methodSynthesizers?$methodSynthesizers.push(e):e()},$synthesizeMethods=function(){$methodSynthesizers.forEach(function(e){e()}),$methodSynthesizers=null},$ifaceKeyFor=function(e){if(e===$ifaceNil)return"nil";var n=e.constructor;return n.string+"$"+n.keyFor(e.$val)},$identity=function(e){return e},$typeIDCounter=0,$idKey=function(e){return void 0===e.$id&&($idCounter++,e.$id=$idCounter),String(e.$id)},$newType=function(e,n,r,t,i,a,o){var $;switch(n){case $kindBool:case $kindInt:case $kindInt8:case $kindInt16:case $kindInt32:case $kindUint:case $kindUint8:case $kindUint16:case $kindUint32:case $kindUintptr:case $kindUnsafePointer:($=function(e){this.$val=e}).wrapped=!0,$.keyFor=$identity;break;case $kindString:($=function(e){this.$val=e}).wrapped=!0,$.keyFor=function(e){return"$"+e};break;case $kindFloat32:case $kindFloat64:($=function(e){this.$val=e}).wrapped=!0,$.keyFor=function(e){return $floatKey(e)};break;case $kindInt64:($=function(e,n){this.$high=e+Math.floor(Math.ceil(n)/4294967296)>>0,this.$low=n>>>0,this.$val=this}).keyFor=function(e){return e.$high+"$"+e.$low};break;case $kindUint64:($=function(e,n){this.$high=e+Math.floor(Math.ceil(n)/4294967296)>>>0,this.$low=n>>>0,this.$val=this}).keyFor=function(e){return e.$high+"$"+e.$low};break;case $kindComplex64:($=function(e,n){this.$real=$fround(e),this.$imag=$fround(n),this.$val=this}).keyFor=function(e){return e.$real+"$"+e.$imag};break;case $kindComplex128:($=function(e,n){this.$real=e,this.$imag=n,this.$val=this}).keyFor=function(e){return e.$real+"$"+e.$imag};break;case $kindArray:($=function(e){this.$val=e}).wrapped=!0,$.ptr=$newType(4,$kindPtr,"*"+r,!1,"",!1,function(e){this.$get=function(){return e},this.$set=function(e){$.copy(this,e)},this.$val=e}),$.init=function(e,n){$.elem=e,$.len=n,$.comparable=e.comparable,$.keyFor=function(n){return Array.prototype.join.call($mapArray(n,function(n){return String(e.keyFor(n)).replace(/\\/g,"\\\\").replace(/\$/g,"\\$")}),"$")},$.copy=function(n,r){$copyArray(n,r,0,0,r.length,e)},$.ptr.init($),Object.defineProperty($.ptr.nil,"nilCheck",{get:$throwNilPointerError})};break;case $kindChan:($=function(e){this.$val=e}).wrapped=!0,$.keyFor=$idKey,$.init=function(e,n,r){$.elem=e,$.sendOnly=n,$.recvOnly=r};break;case $kindFunc:($=function(e){this.$val=e}).wrapped=!0,$.init=function(e,n,r){$.params=e,$.results=n,$.variadic=r,$.comparable=!1};break;case $kindInterface:($={implementedBy:{},missingMethodFor:{}}).keyFor=$ifaceKeyFor,$.init=function(e){$.methods=e,e.forEach(function(e){$ifaceNil[e.prop]=$throwNilPointerError})};break;case $kindMap:($=function(e){this.$val=e}).wrapped=!0,$.init=function(e,n){$.key=e,$.elem=n,$.comparable=!1};break;case $kindPtr:($=o||function(e,n,r){this.$get=e,this.$set=n,this.$target=r,this.$val=this}).keyFor=$idKey,$.init=function(e){$.elem=e,$.wrapped=e.kind===$kindArray,$.nil=new $($throwNilPointerError,$throwNilPointerError)};break;case $kindSlice:($=function(e){e.constructor!==$.nativeArray&&(e=new $.nativeArray(e)),this.$array=e,this.$offset=0,this.$length=e.length,this.$capacity=e.length,this.$val=this}).init=function(e){$.elem=e,$.comparable=!1,$.nativeArray=$nativeArray(e.kind),$.nil=new $([])};break;case $kindStruct:($=function(e){this.$val=e}).wrapped=!0,$.ptr=$newType(4,$kindPtr,"*"+r,!1,i,a,o),$.ptr.elem=$,$.ptr.prototype.$get=function(){return this},$.ptr.prototype.$set=function(e){$.copy(this,e)},$.init=function(e,n){$.pkgPath=e,$.fields=n,n.forEach(function(e){e.typ.comparable||($.comparable=!1)}),$.keyFor=function(e){var r=e.$val;return $mapArray(n,function(e){return String(e.typ.keyFor(r[e.prop])).replace(/\\/g,"\\\\").replace(/\$/g,"\\$")}).join("$")},$.copy=function(e,r){for(var t=0;t<n.length;t++){var i=n[t];switch(i.typ.kind){case $kindArray:case $kindStruct:i.typ.copy(e[i.prop],r[i.prop]);continue;default:e[i.prop]=r[i.prop];continue}}};var r={};n.forEach(function(e){r[e.prop]={get:$throwNilPointerError,set:$throwNilPointerError}}),$.ptr.nil=Object.create(o.prototype,r),$.ptr.nil.$val=$.ptr.nil,$addMethodSynthesizer(function(){var e=function(e,n,r){void 0===e.prototype[n.prop]&&(e.prototype[n.prop]=function(){var e=this.$val[r.prop];return r.typ===$jsObjectPtr&&(e=new $jsObjectPtr(e)),void 0===e.$val&&(e=new r.typ(e)),e[n.prop].apply(e,arguments)})};n.forEach(function(n){n.anonymous&&($methodSet(n.typ).forEach(function(r){e($,r,n),e($.ptr,r,n)}),$methodSet($ptrType(n.typ)).forEach(function(r){e($.ptr,r,n)}))})})};break;default:$panic(new $String("invalid kind: "+n))}switch(n){case $kindBool:case $kindMap:$.zero=function(){return!1};break;case $kindInt:case $kindInt8:case $kindInt16:case $kindInt32:case $kindUint:case $kindUint8:case $kindUint16:case $kindUint32:case $kindUintptr:case $kindUnsafePointer:case $kindFloat32:case $kindFloat64:$.zero=function(){return 0};break;case $kindString:$.zero=function(){return""};break;case $kindInt64:case $kindUint64:case $kindComplex64:case $kindComplex128:var c=new $(0,0);$.zero=function(){return c};break;case $kindPtr:case $kindSlice:$.zero=function(){return $.nil};break;case $kindChan:$.zero=function(){return $chanNil};break;case $kindFunc:$.zero=function(){return $throwNilPointerError};break;case $kindInterface:$.zero=function(){return $ifaceNil};break;case $kindArray:$.zero=function(){var e=$nativeArray($.elem.kind);if(e!==Array)return new e($.len);for(var n=new Array($.len),r=0;r<$.len;r++)n[r]=$.elem.zero();return n};break;case $kindStruct:$.zero=function(){return new $.ptr};break;default:$panic(new $String("invalid kind: "+n))}return $.id=$typeIDCounter,$typeIDCounter++,$.size=e,$.kind=n,$.string=r,$.named=t,$.pkg=i,$.exported=a,$.methods=[],$.methodSetCache=null,$.comparable=!0,$},$methodSet=function(e){if(null!==e.methodSetCache)return e.methodSetCache;var n={},r=e.kind===$kindPtr;if(r&&e.elem.kind===$kindInterface)return e.methodSetCache=[],[];for(var t=[{typ:r?e.elem:e,indirect:r}],i={};t.length>0;){var a=[],o=[];t.forEach(function(e){if(!i[e.typ.string])switch(i[e.typ.string]=!0,e.typ.named&&(o=o.concat(e.typ.methods),e.indirect&&(o=o.concat($ptrType(e.typ).methods))),e.typ.kind){case $kindStruct:e.typ.fields.forEach(function(n){if(n.anonymous){var r=n.typ,t=r.kind===$kindPtr;a.push({typ:t?r.elem:r,indirect:e.indirect||t})}});break;case $kindInterface:o=o.concat(e.typ.methods)}}),o.forEach(function(e){void 0===n[e.name]&&(n[e.name]=e)}),t=a}return e.methodSetCache=[],Object.keys(n).sort().forEach(function(r){e.methodSetCache.push(n[r])}),e.methodSetCache},$Bool=$newType(1,$kindBool,"bool",!0,"",!1,null),$Int=$newType(4,$kindInt,"int",!0,"",!1,null),$Int8=$newType(1,$kindInt8,"int8",!0,"",!1,null),$Int16=$newType(2,$kindInt16,"int16",!0,"",!1,null),$Int32=$newType(4,$kindInt32,"int32",!0,"",!1,null),$Int64=$newType(8,$kindInt64,"int64",!0,"",!1,null),$Uint=$newType(4,$kindUint,"uint",!0,"",!1,null),$Uint8=$newType(1,$kindUint8,"uint8",!0,"",!1,null),$Uint16=$newType(2,$kindUint16,"uint16",!0,"",!1,null),$Uint32=$newType(4,$kindUint32,"uint32",!0,"",!1,null),$Uint64=$newType(8,$kindUint64,"uint64",!0,"",!1,null),$Uintptr=$newType(4,$kindUintptr,"uintptr",!0,"",!1,null),$Float32=$newType(4,$kindFloat32,"float32",!0,"",!1,null),$Float64=$newType(8,$kindFloat64,"float64",!0,"",!1,null),$Complex64=$newType(8,$kindComplex64,"complex64",!0,"",!1,null),$Complex128=$newType(16,$kindComplex128,"complex128",!0,"",!1,null),$String=$newType(8,$kindString,"string",!0,"",!1,null),$UnsafePointer=$newType(4,$kindUnsafePointer,"unsafe.Pointer",!0,"",!1,null),$nativeArray=function(e){switch(e){case $kindInt:return Int32Array;case $kindInt8:return Int8Array;case $kindInt16:return Int16Array;case $kindInt32:return Int32Array;case $kindUint:return Uint32Array;case $kindUint8:return Uint8Array;case $kindUint16:return Uint16Array;case $kindUint32:case $kindUintptr:return Uint32Array;case $kindFloat32:return Float32Array;case $kindFloat64:return Float64Array;default:return Array}},$toNativeArray=function(e,n){var r=$nativeArray(e);return r===Array?n:new r(n)},$arrayTypes={},$arrayType=function(e,n){var r=e.id+"$"+n,t=$arrayTypes[r];return void 0===t&&(t=$newType(12,$kindArray,"["+n+"]"+e.string,!1,"",!1,null),$arrayTypes[r]=t,t.init(e,n)),t},$chanType=function(e,n,r){var t=(r?"<-":"")+"chan"+(n?"<- ":" ")+e.string,i=n?"SendChan":r?"RecvChan":"Chan",a=e[i];return void 0===a&&(a=$newType(4,$kindChan,t,!1,"",!1,null),e[i]=a,a.init(e,n,r)),a},$Chan=function(e,n){(n<0||n>2147483647)&&$throwRuntimeError("makechan: size out of range"),this.$elem=e,this.$capacity=n,this.$buffer=[],this.$sendQueue=[],this.$recvQueue=[],this.$closed=!1},$chanNil=new $Chan(null,0);$chanNil.$sendQueue=$chanNil.$recvQueue={length:0,push:function(){},shift:function(){},indexOf:function(){return-1}};var $funcTypes={},$funcType=function(e,n,r){var t=$mapArray(e,function(e){return e.id}).join(",")+"$"+$mapArray(n,function(e){return e.id}).join(",")+"$"+r,i=$funcTypes[t];if(void 0===i){var a=$mapArray(e,function(e){return e.string});r&&(a[a.length-1]="..."+a[a.length-1].substr(2));var o="func("+a.join(", ")+")";1===n.length?o+=" "+n[0].string:n.length>1&&(o+=" ("+$mapArray(n,function(e){return e.string}).join(", ")+")"),i=$newType(4,$kindFunc,o,!1,"",!1,null),$funcTypes[t]=i,i.init(e,n,r)}return i},$interfaceTypes={},$interfaceType=function(e){var n=$mapArray(e,function(e){return e.pkg+","+e.name+","+e.typ.id}).join("$"),r=$interfaceTypes[n];if(void 0===r){var t="interface {}";0!==e.length&&(t="interface { "+$mapArray(e,function(e){return(""!==e.pkg?e.pkg+".":"")+e.name+e.typ.string.substr(4)}).join("; ")+" }"),r=$newType(8,$kindInterface,t,!1,"",!1,null),$interfaceTypes[n]=r,r.init(e)}return r},$emptyInterface=$interfaceType([]),$ifaceNil={},$error=$newType(8,$kindInterface,"error",!0,"",!1,null);$error.init([{prop:"Error",name:"Error",pkg:"",typ:$funcType([],[$String],!1)}]);var $panicValue,$jsObjectPtr,$jsErrorPtr,$mapTypes={},$mapType=function(e,n){var r=e.id+"$"+n.id,t=$mapTypes[r];return void 0===t&&(t=$newType(4,$kindMap,"map["+e.string+"]"+n.string,!1,"",!1,null),$mapTypes[r]=t,t.init(e,n)),t},$makeMap=function(e,n){for(var r={},t=0;t<n.length;t++){var i=n[t];r[e(i.k)]=i}return r},$ptrType=function(e){var n=e.ptr;return void 0===n&&(n=$newType(4,$kindPtr,"*"+e.string,!1,"",e.exported,null),e.ptr=n,n.init(e)),n},$newDataPointer=function(e,n){return n.elem.kind===$kindStruct?e:new n(function(){return e},function(n){e=n})},$indexPtr=function(e,n,r){return e.$ptr=e.$ptr||{},e.$ptr[n]||(e.$ptr[n]=new r(function(){return e[n]},function(r){e[n]=r}))},$sliceType=function(e){var n=e.slice;return void 0===n&&(n=$newType(12,$kindSlice,"[]"+e.string,!1,"",!1,null),e.slice=n,n.init(e)),n},$makeSlice=function(e,n,r){r=r||n,(n<0||n>2147483647)&&$throwRuntimeError("makeslice: len out of range"),(r<0||r<n||r>2147483647)&&$throwRuntimeError("makeslice: cap out of range");var t=new e.nativeArray(r);if(e.nativeArray===Array)for(var i=0;i<r;i++)t[i]=e.elem.zero();var a=new e(t);return a.$length=n,a},$structTypes={},$structType=function(e,n){var r=$mapArray(n,function(e){return e.name+","+e.typ.id+","+e.tag}).join("$"),t=$structTypes[r];if(void 0===t){var i="struct { "+$mapArray(n,function(e){return e.name+" "+e.typ.string+(""!==e.tag?' "'+e.tag.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"':"")}).join("; ")+" }";0===n.length&&(i="struct {}"),t=$newType(0,$kindStruct,i,!1,"",!1,function(){this.$val=this;for(var e=0;e<n.length;e++){var r=n[e],t=arguments[e];this[r.prop]=void 0!==t?t:r.typ.zero()}}),$structTypes[r]=t,t.init(e,n)}return t},$assertType=function(e,n,r){var t,i=n.kind===$kindInterface,a="";if(e===$ifaceNil)t=!1;else if(i){var o=e.constructor.string;if(void 0===(t=n.implementedBy[o])){t=!0;for(var $=$methodSet(e.constructor),c=n.methods,u=0;u<c.length;u++){for(var l=c[u],s=!1,f=0;f<$.length;f++){var d=$[f];if(d.name===l.name&&d.pkg===l.pkg&&d.typ===l.typ){s=!0;break}}if(!s){t=!1,n.missingMethodFor[o]=l.name;break}}n.implementedBy[o]=t}t||(a=n.missingMethodFor[o])}else t=e.constructor===n;if(!t){if(r)return[n.zero(),!1];$panic(new $packages.runtime.TypeAssertionError.ptr("",e===$ifaceNil?"":e.constructor.string,n.string,a))}return i||(e=e.$val),n===$jsObjectPtr&&(e=e.object),r?[e,!0]:e},$stackDepthOffset=0,$getStackDepth=function(){var e=new Error;if(void 0!==e.stack)return $stackDepthOffset+e.stack.split("\n").length},$panicStackDepth=null,$callDeferred=function(e,n,r){if(!r&&null!==e&&e.index>=$curGoroutine.deferStack.length)throw n;if(null!==n){var t=null;try{$curGoroutine.deferStack.push(e),$panic(new $jsErrorPtr(n))}catch(e){t=e}return $curGoroutine.deferStack.pop(),void $callDeferred(e,t)}if(!$curGoroutine.asleep){$stackDepthOffset--;var i=$panicStackDepth,a=$panicValue,o=$curGoroutine.panicStack.pop();void 0!==o&&($panicStackDepth=$getStackDepth(),$panicValue=o);try{for(;;){if(null===e&&void 0===(e=$curGoroutine.deferStack[$curGoroutine.deferStack.length-1])){if($panicStackDepth=null,o.Object instanceof Error)throw o.Object;var $;throw $=o.constructor===$String?o.$val:void 0!==o.Error?o.Error():void 0!==o.String?o.String():o,new Error($)}var c=e.pop();if(void 0===c){if($curGoroutine.deferStack.pop(),void 0!==o){e=null;continue}return}var u=c[0].apply(c[2],c[1]);if(u&&void 0!==u.$blk){if(e.push([u.$blk,[],u]),r)throw null;return}if(void 0!==o&&null===$panicStackDepth)throw null}}finally{void 0!==o&&(null!==$panicStackDepth&&$curGoroutine.panicStack.push(o),$panicStackDepth=i,$panicValue=a),$stackDepthOffset++}}},$panic=function(e){$curGoroutine.panicStack.push(e),$callDeferred(null,null,!0)},$recover=function(){return null===$panicStackDepth||void 0!==$panicStackDepth&&$panicStackDepth!==$getStackDepth()-2?$ifaceNil:($panicStackDepth=null,$panicValue)},$throw=function(e){throw e},$noGoroutine={asleep:!1,exit:!1,deferStack:[],panicStack:[]},$curGoroutine=$noGoroutine,$totalGoroutines=0,$awakeGoroutines=0,$checkForDeadlock=!0,$mainFinished=!1,$go=function(e,n){$totalGoroutines++,$awakeGoroutines++;var r=function(){try{$curGoroutine=r;var t=e.apply(void 0,n);if(t&&void 0!==t.$blk)return e=function(){return t.$blk()},void(n=[]);r.exit=!0}catch(e){if(!r.exit)throw e}finally{$curGoroutine=$noGoroutine,r.exit&&($totalGoroutines--,r.asleep=!0),r.asleep&&($awakeGoroutines--,!$mainFinished&&0===$awakeGoroutines&&$checkForDeadlock&&(console.error("fatal error: all goroutines are asleep - deadlock!"),void 0!==$global.process&&$global.process.exit(2)))}};r.asleep=!1,r.exit=!1,r.deferStack=[],r.panicStack=[],$schedule(r)},$scheduled=[],$runScheduled=function(){try{for(var e;void 0!==(e=$scheduled.shift());)e()}finally{$scheduled.length>0&&setTimeout($runScheduled,0)}},$schedule=function(e){e.asleep&&(e.asleep=!1,$awakeGoroutines++),$scheduled.push(e),$curGoroutine===$noGoroutine&&$runScheduled()},$setTimeout=function(e,n){return $awakeGoroutines++,setTimeout(function(){$awakeGoroutines--,e()},n)},$block=function(){$curGoroutine===$noGoroutine&&$throwRuntimeError("cannot block in JavaScript callback, fix by wrapping code in goroutine"),$curGoroutine.asleep=!0},$send=function(e,n){e.$closed&&$throwRuntimeError("send on closed channel");var r=e.$recvQueue.shift();if(void 0===r){if(!(e.$buffer.length<e.$capacity)){var t,i=$curGoroutine;return e.$sendQueue.push(function(e){return t=e,$schedule(i),n}),$block(),{$blk:function(){t&&$throwRuntimeError("send on closed channel")}}}e.$buffer.push(n)}else r([n,!0])},$recv=function(e){var n=e.$sendQueue.shift();void 0!==n&&e.$buffer.push(n(!1));var r=e.$buffer.shift();if(void 0!==r)return[r,!0];if(e.$closed)return[e.$elem.zero(),!1];var t=$curGoroutine,i={$blk:function(){return this.value}};return e.$recvQueue.push(function(e){i.value=e,$schedule(t)}),$block(),i},$close=function(e){for(e.$closed&&$throwRuntimeError("close of closed channel"),e.$closed=!0;;){var n=e.$sendQueue.shift();if(void 0===n)break;n(!0)}for(;;){var r=e.$recvQueue.shift();if(void 0===r)break;r([e.$elem.zero(),!1])}},$select=function(e){for(var n=[],r=-1,t=0;t<e.length;t++){var i,a=(i=e[t])[0];switch(i.length){case 0:r=t;break;case 1:(0!==a.$sendQueue.length||0!==a.$buffer.length||a.$closed)&&n.push(t);break;case 2:a.$closed&&$throwRuntimeError("send on closed channel"),(0!==a.$recvQueue.length||a.$buffer.length<a.$capacity)&&n.push(t)}}if(0!==n.length&&(r=n[Math.floor(Math.random()*n.length)]),-1!==r)switch((i=e[r]).length){case 0:return[r];case 1:return[r,$recv(i[0])];case 2:return $send(i[0],i[1]),[r]}var o=[],$=$curGoroutine,c={$blk:function(){return this.selection}},u=function(){for(var e=0;e<o.length;e++){var n=o[e],r=n[0],t=r.indexOf(n[1]);-1!==t&&r.splice(t,1)}};for(t=0;t<e.length;t++)!function(n){var r=e[n];switch(r.length){case 1:var t=function(e){c.selection=[n,e],u(),$schedule($)};o.push([r[0].$recvQueue,t]),r[0].$recvQueue.push(t);break;case 2:t=function(){return r[0].$closed&&$throwRuntimeError("send on closed channel"),c.selection=[n],u(),$schedule($),r[1]};o.push([r[0].$sendQueue,t]),r[0].$sendQueue.push(t)}}(t);return $block(),c},$needsExternalization=function(e){switch(e.kind){case $kindBool:case $kindInt:case $kindInt8:case $kindInt16:case $kindInt32:case $kindUint:case $kindUint8:case $kindUint16:case $kindUint32:case $kindUintptr:case $kindFloat32:case $kindFloat64:return!1;default:return e!==$jsObjectPtr}},$externalize=function(e,n){if(n===$jsObjectPtr)return e;switch(n.kind){case $kindBool:case $kindInt:case $kindInt8:case $kindInt16:case $kindInt32:case $kindUint:case $kindUint8:case $kindUint16:case $kindUint32:case $kindUintptr:case $kindFloat32:case $kindFloat64:return e;case $kindInt64:case $kindUint64:return $flatten64(e);case $kindArray:return $needsExternalization(n.elem)?$mapArray(e,function(e){return $externalize(e,n.elem)}):e;case $kindFunc:return $externalizeFunction(e,n,!1);case $kindInterface:return e===$ifaceNil?null:e.constructor===$jsObjectPtr?e.$val.object:$externalize(e.$val,e.constructor);case $kindMap:for(var r={},t=$keys(e),i=0;i<t.length;i++){var a=e[t[i]];r[$externalize(a.k,n.key)]=$externalize(a.v,n.elem)}return r;case $kindPtr:return e===n.nil?null:$externalize(e.$get(),n.elem);case $kindSlice:return $needsExternalization(n.elem)?$mapArray($sliceToArray(e),function(e){return $externalize(e,n.elem)}):$sliceToArray(e);case $kindString:if($isASCII(e))return e;var o,$="";for(i=0;i<e.length;i+=o[1]){var c=(o=$decodeRune(e,i))[0];if(c>65535){var u=Math.floor((c-65536)/1024)+55296,l=(c-65536)%1024+56320;$+=String.fromCharCode(u,l)}else $+=String.fromCharCode(c)}return $;case $kindStruct:var s=$packages.time;if(void 0!==s&&e.constructor===s.Time.ptr){var f=$div64(e.UnixNano(),new $Int64(0,1e6));return new Date($flatten64(f))}var d={},p=function(e,n){if(n===$jsObjectPtr)return e;switch(n.kind){case $kindPtr:return e===n.nil?d:p(e.$get(),n.elem);case $kindStruct:var r=n.fields[0];return p(e[r.prop],r.typ);case $kindInterface:return p(e.$val,e.constructor);default:return d}},h=p(e,n);if(h!==d)return h;h={};for(i=0;i<n.fields.length;i++){var k=n.fields[i];k.exported&&(h[k.name]=$externalize(e[k.prop],k.typ))}return h}$throwRuntimeError("cannot externalize "+n.string)},$externalizeFunction=function(e,n,r){return e===$throwNilPointerError?null:(void 0===e.$externalizeWrapper&&($checkForDeadlock=!1,e.$externalizeWrapper=function(){for(var t=[],i=0;i<n.params.length;i++){if(n.variadic&&i===n.params.length-1){for(var a=n.params[i].elem,o=[],$=i;$<arguments.length;$++)o.push($internalize(arguments[$],a));t.push(new n.params[i](o));break}t.push($internalize(arguments[i],n.params[i]))}var c=e.apply(r?this:void 0,t);switch(n.results.length){case 0:return;case 1:return $externalize(c,n.results[0]);default:for(i=0;i<n.results.length;i++)c[i]=$externalize(c[i],n.results[i]);return c}}),e.$externalizeWrapper)},$internalize=function(e,n,r){if(n===$jsObjectPtr)return e;if(n===$jsObjectPtr.elem&&$throwRuntimeError("cannot internalize js.Object, use *js.Object instead"),e&&void 0!==e.__internal_object__)return $assertType(e.__internal_object__,n,!1);var t=$packages.time;if(void 0!==t&&n===t.Time)return null!==e&&void 0!==e&&e.constructor===Date||$throwRuntimeError("cannot internalize time.Time from "+typeof e+", must be Date"),t.Unix(new $Int64(0,0),new $Int64(0,1e6*e.getTime()));switch(n.kind){case $kindBool:return!!e;case $kindInt:return parseInt(e);case $kindInt8:return parseInt(e)<<24>>24;case $kindInt16:return parseInt(e)<<16>>16;case $kindInt32:return parseInt(e)>>0;case $kindUint:return parseInt(e);case $kindUint8:return parseInt(e)<<24>>>24;case $kindUint16:return parseInt(e)<<16>>>16;case $kindUint32:case $kindUintptr:return parseInt(e)>>>0;case $kindInt64:case $kindUint64:return new n(0,e);case $kindFloat32:case $kindFloat64:return parseFloat(e);case $kindArray:return e.length!==n.len&&$throwRuntimeError("got array with wrong size from JavaScript native"),$mapArray(e,function(e){return $internalize(e,n.elem)});case $kindFunc:return function(){for(var t=[],i=0;i<n.params.length;i++){if(n.variadic&&i===n.params.length-1){for(var a=n.params[i].elem,o=arguments[i],$=0;$<o.$length;$++)t.push($externalize(o.$array[o.$offset+$],a));break}t.push($externalize(arguments[i],n.params[i]))}var c=e.apply(r,t);switch(n.results.length){case 0:return;case 1:return $internalize(c,n.results[0]);default:for(i=0;i<n.results.length;i++)c[i]=$internalize(c[i],n.results[i]);return c}};case $kindInterface:if(0!==n.methods.length&&$throwRuntimeError("cannot internalize "+n.string),null===e)return $ifaceNil;if(void 0===e)return new $jsObjectPtr(void 0);switch(e.constructor){case Int8Array:return new($sliceType($Int8))(e);case Int16Array:return new($sliceType($Int16))(e);case Int32Array:return new($sliceType($Int))(e);case Uint8Array:return new($sliceType($Uint8))(e);case Uint16Array:return new($sliceType($Uint16))(e);case Uint32Array:return new($sliceType($Uint))(e);case Float32Array:return new($sliceType($Float32))(e);case Float64Array:return new($sliceType($Float64))(e);case Array:return $internalize(e,$sliceType($emptyInterface));case Boolean:return new $Bool(!!e);case Date:return void 0===t?new $jsObjectPtr(e):new t.Time($internalize(e,t.Time));case Function:var i=$funcType([$sliceType($emptyInterface)],[$jsObjectPtr],!0);return new i($internalize(e,i));case Number:return new $Float64(parseFloat(e));case String:return new $String($internalize(e,$String));default:if($global.Node&&e instanceof $global.Node)return new $jsObjectPtr(e);var a=$mapType($String,$emptyInterface);return new a($internalize(e,a))}case $kindMap:for(var o={},$=$keys(e),c=0;c<$.length;c++){var u=$internalize($[c],n.key);o[n.key.keyFor(u)]={k:u,v:$internalize(e[$[c]],n.elem)}}return o;case $kindPtr:if(n.elem.kind===$kindStruct)return $internalize(e,n.elem);case $kindSlice:return new n($mapArray(e,function(e){return $internalize(e,n.elem)}));case $kindString:if(e=String(e),$isASCII(e))return e;var l="";for(c=0;c<e.length;){var s=e.charCodeAt(c);if(55296<=s&&s<=56319){var f=e.charCodeAt(c+1);l+=$encodeRune(1024*(s-55296)+f-56320+65536),c+=2}else l+=$encodeRune(s),c++}return l;case $kindStruct:var d={},p=function(n){if(n===$jsObjectPtr)return e;switch(n===$jsObjectPtr.elem&&$throwRuntimeError("cannot internalize js.Object, use *js.Object instead"),n.kind){case $kindPtr:return p(n.elem);case $kindStruct:var r=n.fields[0],t=p(r.typ);if(t!==d){var i=new n.ptr;return i[r.prop]=t,i}return d;default:return d}},h=p(n);if(h!==d)return h}$throwRuntimeError("cannot internalize "+n.string)},$isASCII=function(e){for(var n=0;n<e.length;n++)if(e.charCodeAt(n)>=128)return!1;return!0};

$packages["github.com/gopherjs/gopherjs/js"]=(function(){var $pkg={},$init,A,B,L,N,Q,K;A=$pkg.Object=$newType(0,$kindStruct,"js.Object",true,"github.com/gopherjs/gopherjs/js",true,function(object_){this.$val=this;if(arguments.length===0){this.object=null;return;}this.object=object_;});B=$pkg.Error=$newType(0,$kindStruct,"js.Error",true,"github.com/gopherjs/gopherjs/js",true,function(Object_){this.$val=this;if(arguments.length===0){this.Object=null;return;}this.Object=Object_;});L=$sliceType($emptyInterface);N=$ptrType(A);Q=$ptrType(B);A.ptr.prototype.Get=function(a){var a,b;b=this;return b.object[$externalize(a,$String)];};A.prototype.Get=function(a){return this.$val.Get(a);};A.ptr.prototype.Set=function(a,b){var a,b,c;c=this;c.object[$externalize(a,$String)]=$externalize(b,$emptyInterface);};A.prototype.Set=function(a,b){return this.$val.Set(a,b);};A.ptr.prototype.Delete=function(a){var a,b;b=this;delete b.object[$externalize(a,$String)];};A.prototype.Delete=function(a){return this.$val.Delete(a);};A.ptr.prototype.Length=function(){var a;a=this;return $parseInt(a.object.length);};A.prototype.Length=function(){return this.$val.Length();};A.ptr.prototype.Index=function(a){var a,b;b=this;return b.object[a];};A.prototype.Index=function(a){return this.$val.Index(a);};A.ptr.prototype.SetIndex=function(a,b){var a,b,c;c=this;c.object[a]=$externalize(b,$emptyInterface);};A.prototype.SetIndex=function(a,b){return this.$val.SetIndex(a,b);};A.ptr.prototype.Call=function(a,b){var a,b,c,d;c=this;return(d=c.object,d[$externalize(a,$String)].apply(d,$externalize(b,L)));};A.prototype.Call=function(a,b){return this.$val.Call(a,b);};A.ptr.prototype.Invoke=function(a){var a,b;b=this;return b.object.apply(undefined,$externalize(a,L));};A.prototype.Invoke=function(a){return this.$val.Invoke(a);};A.ptr.prototype.New=function(a){var a,b;b=this;return new($global.Function.prototype.bind.apply(b.object,[undefined].concat($externalize(a,L))));};A.prototype.New=function(a){return this.$val.New(a);};A.ptr.prototype.Bool=function(){var a;a=this;return!!(a.object);};A.prototype.Bool=function(){return this.$val.Bool();};A.ptr.prototype.String=function(){var a;a=this;return $internalize(a.object,$String);};A.prototype.String=function(){return this.$val.String();};A.ptr.prototype.Int=function(){var a;a=this;return $parseInt(a.object)>>0;};A.prototype.Int=function(){return this.$val.Int();};A.ptr.prototype.Int64=function(){var a;a=this;return $internalize(a.object,$Int64);};A.prototype.Int64=function(){return this.$val.Int64();};A.ptr.prototype.Uint64=function(){var a;a=this;return $internalize(a.object,$Uint64);};A.prototype.Uint64=function(){return this.$val.Uint64();};A.ptr.prototype.Float=function(){var a;a=this;return $parseFloat(a.object);};A.prototype.Float=function(){return this.$val.Float();};A.ptr.prototype.Interface=function(){var a;a=this;return $internalize(a.object,$emptyInterface);};A.prototype.Interface=function(){return this.$val.Interface();};A.ptr.prototype.Unsafe=function(){var a;a=this;return a.object;};A.prototype.Unsafe=function(){return this.$val.Unsafe();};B.ptr.prototype.Error=function(){var a;a=this;return"JavaScript error: "+$internalize(a.Object.message,$String);};B.prototype.Error=function(){return this.$val.Error();};B.ptr.prototype.Stack=function(){var a;a=this;return $internalize(a.Object.stack,$String);};B.prototype.Stack=function(){return this.$val.Stack();};K=function(){var a;a=new B.ptr(null);$unused(a);};N.methods=[{prop:"Get",name:"Get",pkg:"",typ:$funcType([$String],[N],false)},{prop:"Set",name:"Set",pkg:"",typ:$funcType([$String,$emptyInterface],[],false)},{prop:"Delete",name:"Delete",pkg:"",typ:$funcType([$String],[],false)},{prop:"Length",name:"Length",pkg:"",typ:$funcType([],[$Int],false)},{prop:"Index",name:"Index",pkg:"",typ:$funcType([$Int],[N],false)},{prop:"SetIndex",name:"SetIndex",pkg:"",typ:$funcType([$Int,$emptyInterface],[],false)},{prop:"Call",name:"Call",pkg:"",typ:$funcType([$String,L],[N],true)},{prop:"Invoke",name:"Invoke",pkg:"",typ:$funcType([L],[N],true)},{prop:"New",name:"New",pkg:"",typ:$funcType([L],[N],true)},{prop:"Bool",name:"Bool",pkg:"",typ:$funcType([],[$Bool],false)},{prop:"String",name:"String",pkg:"",typ:$funcType([],[$String],false)},{prop:"Int",name:"Int",pkg:"",typ:$funcType([],[$Int],false)},{prop:"Int64",name:"Int64",pkg:"",typ:$funcType([],[$Int64],false)},{prop:"Uint64",name:"Uint64",pkg:"",typ:$funcType([],[$Uint64],false)},{prop:"Float",name:"Float",pkg:"",typ:$funcType([],[$Float64],false)},{prop:"Interface",name:"Interface",pkg:"",typ:$funcType([],[$emptyInterface],false)},{prop:"Unsafe",name:"Unsafe",pkg:"",typ:$funcType([],[$Uintptr],false)}];Q.methods=[{prop:"Error",name:"Error",pkg:"",typ:$funcType([],[$String],false)},{prop:"Stack",name:"Stack",pkg:"",typ:$funcType([],[$String],false)}];A.init("github.com/gopherjs/gopherjs/js",[{prop:"object",name:"object",anonymous:false,exported:false,typ:N,tag:""}]);B.init("",[{prop:"Object",name:"Object",anonymous:true,exported:true,typ:N,tag:""}]);$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:K();}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["runtime/internal/sys"]=(function(){var $pkg={},$init;$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["runtime"]=(function(){var $pkg={},$init,B,A,AP,AQ,BF,E,AJ;B=$packages["github.com/gopherjs/gopherjs/js"];A=$packages["runtime/internal/sys"];AP=$pkg.TypeAssertionError=$newType(0,$kindStruct,"runtime.TypeAssertionError",true,"runtime",true,function(interfaceString_,concreteString_,assertedString_,missingMethod_){this.$val=this;if(arguments.length===0){this.interfaceString="";this.concreteString="";this.assertedString="";this.missingMethod="";return;}this.interfaceString=interfaceString_;this.concreteString=concreteString_;this.assertedString=assertedString_;this.missingMethod=missingMethod_;});AQ=$pkg.errorString=$newType(8,$kindString,"runtime.errorString",true,"runtime",false,null);BF=$ptrType(AP);E=function(){var a,b;a=$packages[$externalize("github.com/gopherjs/gopherjs/js",$String)];$jsObjectPtr=a.Object.ptr;$jsErrorPtr=a.Error.ptr;$throwRuntimeError=AJ;b=$ifaceNil;b=new AP.ptr("","","","");$unused(b);};AJ=function(a){var a;$panic(new AQ((a)));};AP.ptr.prototype.RuntimeError=function(){};AP.prototype.RuntimeError=function(){return this.$val.RuntimeError();};AP.ptr.prototype.Error=function(){var a,b;a=this;b=a.interfaceString;if(b===""){b="interface";}if(a.concreteString===""){return"interface conversion: "+b+" is nil, not "+a.assertedString;}if(a.missingMethod===""){return"interface conversion: "+b+" is "+a.concreteString+", not "+a.assertedString;}return"interface conversion: "+a.concreteString+" is not "+a.assertedString+": missing method "+a.missingMethod;};AP.prototype.Error=function(){return this.$val.Error();};AQ.prototype.RuntimeError=function(){var a;a=this.$val;};$ptrType(AQ).prototype.RuntimeError=function(){return new AQ(this.$get()).RuntimeError();};AQ.prototype.Error=function(){var a;a=this.$val;return"runtime error: "+(a);};$ptrType(AQ).prototype.Error=function(){return new AQ(this.$get()).Error();};BF.methods=[{prop:"RuntimeError",name:"RuntimeError",pkg:"",typ:$funcType([],[],false)},{prop:"Error",name:"Error",pkg:"",typ:$funcType([],[$String],false)}];AQ.methods=[{prop:"RuntimeError",name:"RuntimeError",pkg:"",typ:$funcType([],[],false)},{prop:"Error",name:"Error",pkg:"",typ:$funcType([],[$String],false)}];AP.init("runtime",[{prop:"interfaceString",name:"interfaceString",anonymous:false,exported:false,typ:$String,tag:""},{prop:"concreteString",name:"concreteString",anonymous:false,exported:false,typ:$String,tag:""},{prop:"assertedString",name:"assertedString",anonymous:false,exported:false,typ:$String,tag:""},{prop:"missingMethod",name:"missingMethod",anonymous:false,exported:false,typ:$String,tag:""}]);$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=B.$init();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=A.$init();$s=2;case 2:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}E();}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["errors"]=(function(){var $pkg={},$init,B,C,A;B=$pkg.errorString=$newType(0,$kindStruct,"errors.errorString",true,"errors",false,function(s_){this.$val=this;if(arguments.length===0){this.s="";return;}this.s=s_;});C=$ptrType(B);A=function(a){var a;return new B.ptr(a);};$pkg.New=A;B.ptr.prototype.Error=function(){var a;a=this;return a.s;};B.prototype.Error=function(){return this.$val.Error();};C.methods=[{prop:"Error",name:"Error",pkg:"",typ:$funcType([],[$String],false)}];B.init("errors",[{prop:"s",name:"s",anonymous:false,exported:false,typ:$String,tag:""}]);$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["github.com/ninchat/ninchat-go/vendor/sort"]=(function(){var $pkg={},$init,A;A=function(a,b){var a,b,c,d,e,f,g,h,i,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=0;d=a;e=c;f=d;case 1:if(!(e<f)){$s=2;continue;}h=e+(g=((f-e>>0))/2,(g===g&&g!==1/0&&g!==-1/0)?g>>0:$throwRuntimeError("integer divide by zero"))>>0;i=b(h);$s=6;case 6:if($c){$c=false;i=i.$blk();}if(i&&i.$blk!==undefined){break s;}if(!i){$s=3;continue;}$s=4;continue;case 3:e=h+1>>0;$s=5;continue;case 4:f=h;case 5:$s=1;continue;case 2:$s=-1;return e;}return;}if($f===undefined){$f={$blk:A};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.$s=$s;$f.$r=$r;return $f;};$pkg.Search=A;$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["github.com/ninchat/ninchat-go"]=(function(){var $pkg={},$init,A,B,C,F,G,H,J,M,Z,AA,AD,AV,AW,AX,AY,BC,BH,BN,BO,BP,BQ,BR,BS,BT,BU,BV,BW,BX,BY,BZ,CA,CB,CC,CD,CE,CF,CG,CH,CI,CJ,CK,CL,CM,CN,W,X,AU,BE,BF,D,E,I,N,O,P,R,S,T,U,V,Y,AB,AC,AE,AF,AG,AH,AI,AJ,AK,AL,AM,AN,AO,AP,AQ,AR,AS,AT,AZ,BA,BB,BD,BG,BI,BJ,BK,BL,BM;A=$packages["errors"];B=$packages["github.com/gopherjs/gopherjs/js"];C=$packages["github.com/ninchat/ninchat-go/vendor/sort"];F=$pkg.Action=$newType(0,$kindStruct,"ninchat.Action",true,"github.com/ninchat/ninchat-go",true,function(Params_,Payload_,OnReply_,id_){this.$val=this;if(arguments.length===0){this.Params=false;this.Payload=BQ.nil;this.OnReply=$throwNilPointerError;this.id=new $Int64(0,0);return;}this.Params=Params_;this.Payload=Payload_;this.OnReply=OnReply_;this.id=id_;});G=$pkg.Event=$newType(0,$kindStruct,"ninchat.Event",true,"github.com/ninchat/ninchat-go",true,function(Params_,Payload_,LastReply_){this.$val=this;if(arguments.length===0){this.Params=false;this.Payload=BQ.nil;this.LastReply=false;return;}this.Params=Params_;this.Payload=Payload_;this.LastReply=LastReply_;});H=$pkg.Frame=$newType(4,$kindPtr,"ninchat.Frame",true,"github.com/ninchat/ninchat-go",true,null);J=$pkg.backoff=$newType(0,$kindStruct,"ninchat.backoff",true,"github.com/ninchat/ninchat-go",false,function(lastSlot_){this.$val=this;if(arguments.length===0){this.lastSlot=0;return;}this.lastSlot=lastSlot_;});M=$pkg.Caller=$newType(0,$kindStruct,"ninchat.Caller",true,"github.com/ninchat/ninchat-go",true,function(Address_){this.$val=this;if(arguments.length===0){this.Address="";return;}this.Address=Address_;});Z=$pkg.httpHeader=$newType(4,$kindMap,"ninchat.httpHeader",true,"github.com/ninchat/ninchat-go",false,null);AA=$pkg.httpRequest=$newType(0,$kindStruct,"ninchat.httpRequest",true,"github.com/ninchat/ninchat-go",false,function(Method_,URL_,Header_,data_){this.$val=this;if(arguments.length===0){this.Method="";this.URL="";this.Header=false;this.data=null;return;}this.Method=Method_;this.URL=URL_;this.Header=Header_;this.data=data_;});AD=$pkg.httpResponse=$newType(0,$kindStruct,"ninchat.httpResponse",true,"github.com/ninchat/ninchat-go",false,function(data_,err_){this.$val=this;if(arguments.length===0){this.data=null;this.err=$ifaceNil;return;}this.data=data_;this.err=err_;});AV=$pkg.Session=$newType(0,$kindStruct,"ninchat.Session",true,"github.com/ninchat/ninchat-go",true,function(OnSessionEvent_,OnEvent_,OnClose_,OnConnState_,OnConnActive_,OnLog_,Address_,forceLongPoll_,sessionParams_,sessionId_,latestConnState_,lastActionId_,sendNotify_,sendBuffer_,numSent_,sendEventAck_,receivedEventId_,ackedEventId_,closeNotify_,closed_,running_){this.$val=this;if(arguments.length===0){this.OnSessionEvent=$throwNilPointerError;this.OnEvent=$throwNilPointerError;this.OnClose=$throwNilPointerError;this.OnConnState=$throwNilPointerError;this.OnConnActive=$throwNilPointerError;this.OnLog=$throwNilPointerError;this.Address="";this.forceLongPoll=false;this.sessionParams=false;this.sessionId=$ifaceNil;this.latestConnState="";this.lastActionId=new $Int64(0,0);this.sendNotify=$chanNil;this.sendBuffer=CC.nil;this.numSent=0;this.sendEventAck=false;this.receivedEventId=new $Int64(0,0);this.ackedEventId=new $Int64(0,0);this.closeNotify=$chanNil;this.closed=false;this.running=false;return;}this.OnSessionEvent=OnSessionEvent_;this.OnEvent=OnEvent_;this.OnClose=OnClose_;this.OnConnState=OnConnState_;this.OnConnActive=OnConnActive_;this.OnLog=OnLog_;this.Address=Address_;this.forceLongPoll=forceLongPoll_;this.sessionParams=sessionParams_;this.sessionId=sessionId_;this.latestConnState=latestConnState_;this.lastActionId=lastActionId_;this.sendNotify=sendNotify_;this.sendBuffer=sendBuffer_;this.numSent=numSent_;this.sendEventAck=sendEventAck_;this.receivedEventId=receivedEventId_;this.ackedEventId=ackedEventId_;this.closeNotify=closeNotify_;this.closed=closed_;this.running=running_;});AW=$pkg.transport=$newType(4,$kindFunc,"ninchat.transport",true,"github.com/ninchat/ninchat-go",false,null);AX=$pkg.duration=$newType(8,$kindInt64,"ninchat.duration",true,"github.com/ninchat/ninchat-go",false,null);AY=$pkg.timeTime=$newType(8,$kindInt64,"ninchat.timeTime",true,"github.com/ninchat/ninchat-go",false,null);BC=$pkg.timer=$newType(0,$kindStruct,"ninchat.timer",true,"github.com/ninchat/ninchat-go",false,function(C_,id_){this.$val=this;if(arguments.length===0){this.C=$chanNil;this.id=null;return;}this.C=C_;this.id=id_;});BH=$pkg.webSocket=$newType(0,$kindStruct,"ninchat.webSocket",true,"github.com/ninchat/ninchat-go",false,function(notify_,goingAway_,err_,impl_,open_,buf_){this.$val=this;if(arguments.length===0){this.notify=$chanNil;this.goingAway=false;this.err=$ifaceNil;this.impl=null;this.open=false;this.buf=CF.nil;return;}this.notify=notify_;this.goingAway=goingAway_;this.err=err_;this.impl=impl_;this.open=open_;this.buf=buf_;});BN=$sliceType($String);BO=$sliceType($emptyInterface);BP=$mapType($String,$emptyInterface);BQ=$sliceType(H);BR=$ptrType(G);BS=$sliceType(BR);BT=$ptrType(BO);BU=$ptrType(BP);BV=$sliceType($Uint8);BW=$ptrType(AA);BX=$funcType([],[],false);BY=$ptrType(B.Object);BZ=$ptrType($Bool);CA=$structType("",[]);CB=$ptrType(F);CC=$sliceType(CB);CD=$ptrType(BC);CE=$ptrType(BH);CF=$sliceType(BY);CG=$funcType([BY],[],false);CH=$funcType([BR],[],false);CI=$ptrType(J);CJ=$ptrType(M);CK=$ptrType(AV);CL=$funcType([$String],[],false);CM=$funcType([BO],[],true);CN=$chanType(CA,false,false);D=function(a){var a;if(a===""){return"api.ninchat.com";}else{return a;}};E=function(a){var a,b,c,d,e,f,g,h,i,j,k,l,m,n;b=BN.nil;c=$ifaceNil;e=(d=a[$String.keyFor("hosts")],d!==undefined?d.v:$ifaceNil);if($interfaceIsEqual(e,$ifaceNil)){c=A.New("invalid endpoint document");return[b,c];}f=$assertType(e,BO,true);g=f[0];h=f[1];if(!h){c=A.New("invalid endpoint hosts type");return[b,c];}if(g.$length===0){c=A.New("no endpoint hosts");return[b,c];}i=g;j=0;while(true){if(!(j<i.$length)){break;}k=((j<0||j>=i.$length)?($throwRuntimeError("index out of range"),undefined):i.$array[i.$offset+j]);l=$assertType(k,$String,true);m=l[0];n=l[1];if(n){b=$append(b,m);}else{c=A.New("invalid endpoint host value type");}j++;}if(b.$length>0){c=$ifaceNil;}return[b,c];};F.ptr.prototype.String=function(){var a,b,c,d,e,f,g;a="";b=this;c=(d=b.Params[$String.keyFor("action")],d!==undefined?[d.v,true]:[$ifaceNil,false]);e=c[0];f=c[1];if(f){g=$assertType(e,$String,true);a=g[0];}return a;};F.prototype.String=function(){return this.$val.String();};G.ptr.prototype.Bool=function(a){var a,b,c,d,e,f;b=false;c=this;e=(d=c.Params[$String.keyFor(a)],d!==undefined?d.v:$ifaceNil);if(!($interfaceIsEqual(e,$ifaceNil))){f=$assertType(e,$Bool,true);b=f[0];}return b;};G.prototype.Bool=function(a){return this.$val.Bool(a);};G.ptr.prototype.Int=function(a){var a,b,c,d,e,f,g,h;b=0;c=false;d=this;f=(e=d.Params[$String.keyFor(a)],e!==undefined?e.v:$ifaceNil);if(!($interfaceIsEqual(f,$ifaceNil))){g=0;h=$assertType(f,$Float64,true);g=h[0];c=h[1];if(c){b=((g>>0));}}return[b,c];};G.prototype.Int=function(a){return this.$val.Int(a);};G.ptr.prototype.Int64=function(a){var a,b,c,d,e,f,g,h;b=new $Int64(0,0);c=false;d=this;f=(e=d.Params[$String.keyFor(a)],e!==undefined?e.v:$ifaceNil);if(!($interfaceIsEqual(f,$ifaceNil))){g=0;h=$assertType(f,$Float64,true);g=h[0];c=h[1];if(c){b=(new $Int64(0,g));}}return[b,c];};G.prototype.Int64=function(a){return this.$val.Int64(a);};G.ptr.prototype.Float64=function(a){var a,b,c,d,e,f,g;b=0;c=false;d=this;f=(e=d.Params[$String.keyFor(a)],e!==undefined?e.v:$ifaceNil);if(!($interfaceIsEqual(f,$ifaceNil))){g=$assertType(f,$Float64,true);b=g[0];c=g[1];}return[b,c];};G.prototype.Float64=function(a){return this.$val.Float64(a);};G.ptr.prototype.Str=function(a){var a,b,c,d,e,f,g;b="";c=false;d=this;f=(e=d.Params[$String.keyFor(a)],e!==undefined?e.v:$ifaceNil);if(!($interfaceIsEqual(f,$ifaceNil))){g=$assertType(f,$String,true);b=g[0];c=g[1];}return[b,c];};G.prototype.Str=function(a){return this.$val.Str(a);};G.ptr.prototype.Array=function(a){var a,b,c,d,e,f,g;b=BO.nil;c=false;d=this;f=(e=d.Params[$String.keyFor(a)],e!==undefined?e.v:$ifaceNil);if(!($interfaceIsEqual(f,$ifaceNil))){g=$assertType(f,BO,true);b=g[0];c=g[1];}return[b,c];};G.prototype.Array=function(a){return this.$val.Array(a);};G.ptr.prototype.Map=function(a){var a,b,c,d,e,f,g;b=false;c=false;d=this;f=(e=d.Params[$String.keyFor(a)],e!==undefined?e.v:$ifaceNil);if(!($interfaceIsEqual(f,$ifaceNil))){g=$assertType(f,BP,true);b=g[0];c=g[1];}return[b,c];};G.prototype.Map=function(a){return this.$val.Map(a);};G.ptr.prototype.String=function(){var a,b,c;a="";b=this;c=b.Str("event");a=c[0];return a;};G.prototype.String=function(){return this.$val.String();};G.ptr.prototype.initLastReply=function(a){var a,b,c,d,e,f;b=this;c=b.Int("history_length");d=c[0];if(d>0){return;}if(b.String()==="search_results"){if(!($interfaceIsEqual((e=b.Params[$String.keyFor("users")],e!==undefined?e.v:$ifaceNil),$ifaceNil))||!($interfaceIsEqual((f=b.Params[$String.keyFor("channels")],f!==undefined?f.v:$ifaceNil),$ifaceNil))){return;}}b.LastReply=true;};G.prototype.initLastReply=function(a){return this.$val.initLastReply(a);};G.ptr.prototype.getError=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;a="";b="";c=false;d=$ifaceNil;e=this;f=(g=e.Params[$String.keyFor("event")],g!==undefined?[g.v,true]:[$ifaceNil,false]);h=f[0];i=f[1];if(!i||!($assertType(h,$String)==="error")){return[a,b,c,d];}a=$assertType((j=e.Params[$String.keyFor("error_type")],j!==undefined?j.v:$ifaceNil),$String);l=(k=e.Params[$String.keyFor("error_reason")],k!==undefined?k.v:$ifaceNil);if(!($interfaceIsEqual(l,$ifaceNil))){b=$assertType(l,$String);}m=a;if(m===("session_not_found")){c=true;if(!(b==="")){d=A.New("error: "+a+" ("+b+")");}else{d=A.New("error: "+a);}}else if(m===("connection_superseded")||m===("message_has_too_many_parts")||m===("message_part_too_long")||m===("message_too_long")||m===("request_malformed")){if(!(b==="")){d=A.New("error: "+a+" ("+b+")");}else{d=A.New("error: "+a);}}return[a,b,c,d];};G.prototype.getError=function(){return this.$val.getError();};I=function(a){var a;return new BQ([a]);};J.ptr.prototype.success=function(){var a;a=this;a.lastSlot=0;};J.prototype.success=function(){return this.$val.success();};J.ptr.prototype.failure=function(a){var a,b,c;b=new AX(0,0);c=this;if(c.lastSlot>0){b=(new AX(0,AG(($flatten64(a))*(c.lastSlot)/1024,-0.5)));}if(c.lastSlot<1023){c.lastSlot=((((c.lastSlot+1>>0))<<1>>0))-1>>0;}return b;};J.prototype.failure=function(a){return this.$val.failure(a);};M.ptr.prototype.Call=function(a){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=[b];c=[c];d=BS.nil;e=$ifaceNil;f=this;g="https://"+D(f.Address)+"/v2/call";h=T(g,a.Params);i=h[0];e=h[1];if(!($interfaceIsEqual(e,$ifaceNil))){$s=-1;return[d,e];}new Z(i.Header).Set("Accept","application/json");new Z(i.Header).Set("Content-Type","application/json");j=AH(new AX(0,11000),0.1);l=AE(i,j);$s=1;case 1:if($c){$c=false;l=l.$blk();}if(l&&l.$blk!==undefined){break s;}k=l;m=k[0];e=k[1];if(!($interfaceIsEqual(e,$ifaceNil))){$s=-1;return[d,e];}b[0]=BO.nil;if(!($interfaceIsEqual(AK(m,(b.$ptr||(b.$ptr=new BT(function(){return this.$target[0];},function($v){this.$target[0]=$v;},b)))),$ifaceNil))){c[0]=false;e=AL(m,(c.$ptr||(c.$ptr=new BU(function(){return this.$target[0];},function($v){this.$target[0]=$v;},c))));if(!($interfaceIsEqual(e,$ifaceNil))){$s=-1;return[d,e];}b[0]=new BO([new BP(c[0])]);}d=$makeSlice(BS,0,b[0].$length);n=b[0];o=0;case 2:if(!(o<n.$length)){$s=3;continue;}p=o;q=((o<0||o>=n.$length)?($throwRuntimeError("index out of range"),undefined):n.$array[n.$offset+o]);r=$assertType(q,BP,true);s=r[0];t=r[1];if(!t){e=A.New("response event header is not an object");$s=-1;return[d,e];}u=new G.ptr(s,BQ.nil,p===(b[0].$length-1>>0));if(!(a.OnReply===$throwNilPointerError)){$s=4;continue;}$s=5;continue;case 4:$r=a.OnReply(u);$s=6;case 6:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 5:d=$append(d,u);o++;$s=2;continue;case 3:$s=-1;return[d,e];}return;}if($f===undefined){$f={$blk:M.ptr.prototype.Call};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.$s=$s;$f.$r=$r;return $f;};M.prototype.Call=function(a){return this.$val.Call(a);};N=function(){return new($global.ArrayBuffer)();};O=function(a){var a;return $parseInt(a.length);};P=function(a){var a;return R(a);};R=function(a){var a,b,c,d,e,f;b=$assertType($internalize(a,$emptyInterface),$String,true);c=b[1];if(c){return a;}d=new($global.Uint8Array)(a);e=$assertType($internalize(d,$emptyInterface),BV);f=($bytesToString(e));return new($global.String)($externalize(f,$String));};$pkg.StringifyFrame=R;S=function(a){var a,b,c,d,e,f;b=$ifaceNil;if(!($interfaceIsEqual(a,$ifaceNil))){c=a;if($assertType(c,$error,true)[1]){d=c;b=d;}else if($assertType(c,$String,true)[1]){e=c.$val;b=A.New(e);}else{f=c;b=A.New("?");}}return b;};T=function(a,b){var a,b,c,d,e,f,g;c=BW.nil;d=$ifaceNil;e=AJ(b);f=e[0];d=e[1];if(!($interfaceIsEqual(d,$ifaceNil))){return[c,d];}g=AC("POST",a,f);c=g[0];d=g[1];return[c,d];};U=function(a,b,c){var a,b,c,d,e,f,g,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:d=new $Chan(AD,1);e=T(a,b);f=e[0];g=e[1];if($interfaceIsEqual(g,$ifaceNil)){$s=1;continue;}$s=2;continue;case 1:$r=AF(f,c,d);$s=4;case 4:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=3;continue;case 2:$r=$send(d,$clone(new AD.ptr(null,g),AD));$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 3:$s=-1;return d;}return;}if($f===undefined){$f={$blk:U};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.$s=$s;$f.$r=$r;return $f;};V=function(a,b){var a,b,c,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=new $Chan(AD,1);$r=AF(a,b,c);$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return c;}return;}if($f===undefined){$f={$blk:V};}$f.a=a;$f.b=b;$f.c=c;$f.$s=$s;$f.$r=$r;return $f;};Y=function(){W=$global.XDomainRequest;if(W===undefined){W=$global.XMLHttpRequest;if(W===undefined){W=$module.require($externalize("xhr2",$String));}X=true;}};Z.prototype.Set=function(a,b){var a,b,c,d;c=this.$val;d=a;(c||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(d)]={k:d,v:b};};$ptrType(Z).prototype.Set=function(a,b){return new Z(this.$get()).Set(a,b);};AB=function(a){var a,b,c;b=BW.nil;c=$ifaceNil;b=new AA.ptr("GET",a,{},null);return[b,c];};AC=function(a,b,c){var a,b,c,d,e;d=BW.nil;e=$ifaceNil;d=new AA.ptr(a,b,{},c);return[d,e];};AE=function(a,b){var a,b,c,d,e,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=V(a,b);$s=1;case 1:if($c){$c=false;c=c.$blk();}if(c&&c.$blk!==undefined){break s;}d=$recv(c);$s=2;case 2:if($c){$c=false;d=d.$blk();}if(d&&d.$blk!==undefined){break s;}e=$clone(d[0],AD);$s=-1;return[e.data,e.err];}return;}if($f===undefined){$f={$blk:AE};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.$s=$s;$f.$r=$r;return $f;};AF=function(a,b,c){var a,b,c,d,e,f,g,h,i,j,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);a=[a];c=[c];d=[d];$deferred.push([(function(a,c,d){return function $b(){var e,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;e=$f.e;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:e=S($recover());if(!($interfaceIsEqual(e,$ifaceNil))){$s=1;continue;}$s=2;continue;case 1:$r=$send(c[0],$clone(new AD.ptr(null,e),AD));$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 2:$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.e=e;$f.$s=$s;$f.$r=$r;return $f;};})(a,c,d),[]]);d[0]=new(W)();d[0].onload=$externalize((function(a,c,d){return function(){var e;e=d[0].responseText;$go((function(a,c,d){return function $b(){var $s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(c[0],$clone(new AD.ptr(e,$ifaceNil),AD));$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$r=$r;return $f;};})(a,c,d),[]);};})(a,c,d),BX);d[0].onprogress=$externalize((function(a,c,d){return function(){$global.setTimeout($externalize((function(a,c,d){return function(){};})(a,c,d),BX),0);};})(a,c,d),BX);d[0].ontimeout=$externalize((function(a,c,d){return function(){$go((function(a,c,d){return function $b(){var $s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(c[0],$clone(new AD.ptr(null,A.New("timeout")),AD));$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$r=$r;return $f;};})(a,c,d),[]);};})(a,c,d),BX);d[0].onerror=$externalize((function(a,c,d){return function(){$go((function(a,c,d){return function $b(){var $s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(c[0],$clone(new AD.ptr(null,A.New("error")),AD));$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$r=$r;return $f;};})(a,c,d),[]);};})(a,c,d),BX);d[0].open($externalize(a[0].Method,$String),$externalize(a[0].URL,$String));d[0].timeout=$externalize(b,AX);if(X){e=a[0].Header;f=0;g=$keys(e);while(true){if(!(f<g.length)){break;}h=e[g[f]];if(h===undefined){f++;continue;}i=h.k;j=h.v;d[0].setRequestHeader($externalize(i,$String),$externalize(j,$String));f++;}}$global.setTimeout($externalize((function(a,c,d){return function(){d[0].send(a[0].data);};})(a,c,d),BX),0);$s=-1;return;}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:AF};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};AG=function(a,b){var a,b;return a+a*b*AT();};AH=function(a,b){var a,b;return(new AX(0,AG(($flatten64(a)),b)));};AI=function(a,b){var a,b;return(new $Int64(0,AG(($flatten64(a)),b)));};AJ=function(a){var a,b,c,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b=null;c=$ifaceNil;$deferred.push([(function(){c=S($recover());}),[]]);b=$global.JSON.stringify($externalize(a,BP));return[b,c];}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[b,c];}}};AK=function(a,b){var a,b,c,d,e,f,g,h;c=$ifaceNil;d=AM(a);e=d[0];c=d[1];if(!($interfaceIsEqual(c,$ifaceNil))){return c;}f=$assertType(e,BO,true);g=f[0];h=f[1];if(!h){c=A.New("json: cannot unmarshal value into Go value of type *[]interface{}");return c;}b.$set(g);return c;};AL=function(a,b){var a,b,c,d,e,f,g,h;c=$ifaceNil;d=AM(a);e=d[0];c=d[1];if(!($interfaceIsEqual(c,$ifaceNil))){return c;}f=$assertType(e,BP,true);g=f[0];h=f[1];if(!h){c=A.New("json: cannot unmarshal value into Go value of type *map[string]interface{}");return c;}b.$set(g);return c;};AM=function(a){var a,b,c,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b=$ifaceNil;c=$ifaceNil;$deferred.push([(function(){c=S($recover());}),[]]);b=$internalize($global.JSON.parse(a),$emptyInterface);return[b,c];}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[b,c];}}};AN=function(a){var a,b,c,d,e,f;b=BO.nil;c=a.Payload;d=0;while(true){if(!(d<c.$length)){break;}e=((d<0||d>=c.$length)?($throwRuntimeError("index out of range"),undefined):c.$array[c.$offset+d]);f=($pointerOfStructConversion(e,BY)).split($externalize(",",$String))[1];b=$append(b,new $jsObjectPtr(f));d++;}return b;};AO=function(a,b){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=[c];d=[d];e=[e];d[0]=false;e[0]=false;f="https://"+b+"/v2/poll";if($interfaceIsEqual(a.sessionId,$ifaceNil)){$s=1;continue;}$s=2;continue;case 1:$r=a.log(new BO([new $String("session creation")]));$s=4;case 4:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}g=a.makeCreateSessionAction();h=AH(new AX(0,13000),0.2);j=U(f,g,h);$s=5;case 5:if($c){$c=false;j=j.$blk();}if(j&&j.$blk!==undefined){break s;}k=$select([[j],[a.closeNotify]]);$s=6;case 6:if($c){$c=false;k=k.$blk();}if(k&&k.$blk!==undefined){break s;}i=k;if(i[0]===0){$s=7;continue;}if(i[0]===1){$s=8;continue;}$s=9;continue;case 7:l=$clone(i[1][0],AD);if(!($interfaceIsEqual(l.err,$ifaceNil))){$s=10;continue;}$s=11;continue;case 10:$r=a.log(new BO([new $String("session creation:"),l.err]));$s=12;case 12:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return[d[0],e[0]];case 11:c[0]=BO.nil;m=AK(l.data,(c.$ptr||(c.$ptr=new BT(function(){return this.$target[0];},function($v){this.$target[0]=$v;},c))));if(!($interfaceIsEqual(m,$ifaceNil))){$s=13;continue;}$s=14;continue;case 13:$r=a.log(new BO([new $String("session creation response:"),m]));$s=15;case 15:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return[d[0],e[0]];case 14:if(c[0].$length===0){$s=16;continue;}$s=17;continue;case 16:$r=a.log(new BO([new $String("session creation response JSON array is empty")]));$s=18;case 18:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return[d[0],e[0]];case 17:n=$assertType((0>=c[0].$length?($throwRuntimeError("index out of range"),undefined):c[0].$array[c[0].$offset+0]),BP,true);o=n[0];p=n[1];if(!p){$s=19;continue;}$s=20;continue;case 19:$r=a.log(new BO([new $String("session creation response header is not a JSON object")]));$s=21;case 21:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return[d[0],e[0]];case 20:q=a.handleSessionEvent(o);$s=24;case 24:if($c){$c=false;q=q.$blk();}if(q&&q.$blk!==undefined){break s;}if(!q){$s=22;continue;}$s=23;continue;case 22:$s=-1;return[d[0],e[0]];case 23:$s=9;continue;case 8:$r=AR(a,f);$s=25;case 25:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return[d[0],e[0]];case 9:d[0]=true;e[0]=true;$r=a.connState("connected");$s=26;case 26:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=a.connActive();$s=27;case 27:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=3;continue;case 2:$r=a.log(new BO([new $String("session resumption")]));$s=28;case 28:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=AQ(a,f);$s=29;case 29:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 3:$r=AP(a,f,(d.$ptr||(d.$ptr=new BZ(function(){return this.$target[0];},function($v){this.$target[0]=$v;},d))),(e.$ptr||(e.$ptr=new BZ(function(){return this.$target[0];},function($v){this.$target[0]=$v;},e))));$s=30;case 30:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return[d[0],e[0]];}return;}if($f===undefined){$f={$blk:AO};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.$s=$s;$f.$r=$r;return $f;};AP=function(a,b,c,d){var a,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;aa=$f.aa;ab=$f.ab;ac=$f.ac;ad=$f.ad;ae=$f.ae;af=$f.af;ag=$f.ag;ah=$f.ah;ai=$f.ai;aj=$f.aj;ak=$f.ak;al=$f.al;am=$f.am;an=$f.an;ao=$f.ao;ap=$f.ap;aq=$f.aq;ar=$f.ar;as=$f.as;at=$f.at;au=$f.au;av=$f.av;aw=$f.aw;ax=$f.ax;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;v=$f.v;w=$f.w;x=$f.x;y=$f.y;z=$f.z;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:e=$chanNil;f=$chanNil;g=new $Int64(0,0);h=0;a.numSent=0;case 1:if(!(h<2)){$s=2;continue;}i=[i];j=[j];if(e===$chanNil){$s=3;continue;}$s=4;continue;case 3:k=a.makeResumeSessionAction(true);l=AH(new AX(0,64000),0.2);m=U(b,k,l);$s=5;case 5:if($c){$c=false;m=m.$blk();}if(m&&m.$blk!==undefined){break s;}e=m;case 4:if(f===$chanNil&&a.numSent<a.sendBuffer.$length){$s=6;continue;}$s=7;continue;case 6:p=(n=a.sendBuffer,o=a.numSent,((o<0||o>=n.$length)?($throwRuntimeError("index out of range"),undefined):n.$array[n.$offset+o]));if(!(p.Payload===BQ.nil)){$s=8;continue;}$s=9;continue;case 8:if(p.String()==="update_user"){$s=10;continue;}$s=11;continue;case 10:q="payload";(p.Params||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(q)]={k:q,v:AN(p)};$s=12;continue;case 11:j[0]=false;s=AL((r=p.Payload,(0>=r.$length?($throwRuntimeError("index out of range"),undefined):r.$array[r.$offset+0])),(j.$ptr||(j.$ptr=new BU(function(){return this.$target[0];},function($v){this.$target[0]=$v;},j))));if(!($interfaceIsEqual(s,$ifaceNil))){$s=13;continue;}$s=14;continue;case 13:$r=a.log(new BO([new $String("send:"),s]));$s=15;case 15:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;case 14:t="payload";(p.Params||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(t)]={k:t,v:new BP(j[0])};case 12:case 9:u="session_id";(p.Params||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(u)]={k:u,v:a.sessionId};v=AH(new AX(0,7000),0.2);w=U(b,p.Params,v);$s=16;case 16:if($c){$c=false;w=w.$blk();}if(w&&w.$blk!==undefined){break s;}x=w;delete p.Params[$String.keyFor("session_id")];delete p.Params[$String.keyFor("payload")];if((y=p.id,(y.$high===0&&y.$low===0))){$go(AS,[a,x,"send error:"]);a.sendBuffer=$appendSlice($subslice(a.sendBuffer,0,a.numSent),$subslice(a.sendBuffer,(a.numSent+1>>0)));}else{f=x;g=p.id;}case 7:z=new AD.ptr(null,$ifaceNil);ab=$select([[e],[f],[a.sendNotify],[a.closeNotify]]);$s=17;case 17:if($c){$c=false;ab=ab.$blk();}if(ab&&ab.$blk!==undefined){break s;}aa=ab;if(aa[0]===0){$s=18;continue;}if(aa[0]===1){$s=19;continue;}if(aa[0]===2){$s=20;continue;}if(aa[0]===3){$s=21;continue;}$s=22;continue;case 18:AD.copy(z,aa[1][0]);if(!($interfaceIsEqual(z.err,$ifaceNil))){$s=23;continue;}$s=24;continue;case 23:$r=a.log(new BO([new $String("poll error:"),z.err]));$s=25;case 25:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 24:e=$chanNil;$r=a.connActive();$s=26;case 26:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=22;continue;case 19:AD.copy(z,aa[1][0]);if(!($interfaceIsEqual(z.err,$ifaceNil))){$s=27;continue;}if((g.$high>0||(g.$high===0&&g.$low>0))){$s=28;continue;}$s=29;continue;case 27:$r=a.log(new BO([new $String("send error:"),z.err]));$s=30;case 30:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=29;continue;case 28:a.numSent=a.numSent+(1)>>0;case 29:f=$chanNil;g=new $Int64(0,0);$s=22;continue;case 20:ac=aa[1];ad=ac[1];if(!ad){$s=31;continue;}$s=32;continue;case 31:$r=AR(a,b);$s=33;case 33:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;case 32:$s=1;continue;$s=22;continue;case 21:$r=AR(a,b);$s=34;case 34:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;case 22:i[0]=BO.nil;ae=z.err;if($interfaceIsEqual(ae,$ifaceNil)){$s=35;continue;}$s=36;continue;case 35:ae=AK(z.data,(i.$ptr||(i.$ptr=new BT(function(){return this.$target[0];},function($v){this.$target[0]=$v;},i))));if(!($interfaceIsEqual(ae,$ifaceNil))){$s=37;continue;}$s=38;continue;case 37:$r=a.log(new BO([new $String("response:"),ae]));$s=39;case 39:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 38:case 36:if(!($interfaceIsEqual(ae,$ifaceNil))){$s=40;continue;}$s=41;continue;case 40:h=h+(1)>>0;a.numSent=0;$s=1;continue;case 41:h=0;c.$set(true);af=i[0];ag=0;case 42:if(!(ag<af.$length)){$s=43;continue;}ah=((ag<0||ag>=af.$length)?($throwRuntimeError("index out of range"),undefined):af.$array[af.$offset+ag]);ai=$assertType(ah,BP,true);aj=ai[0];ak=ai[1];if(!ak){$s=44;continue;}$s=45;continue;case 44:$r=a.log(new BO([new $String("poll event is not an object")]));$s=46;case 46:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;case 45:al=new G.ptr(aj,BQ.nil,false);an=(am=aj[$String.keyFor("payload")],am!==undefined?am.v:$ifaceNil);if(!($interfaceIsEqual(an,$ifaceNil))){$s=47;continue;}$s=48;continue;case 47:ao=$assertType(an,BP,true);ap=ao[0];aq=ao[1];if(!aq){$s=49;continue;}$s=50;continue;case 49:$r=a.log(new BO([new $String("poll payload is not an object")]));$s=51;case 51:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;case 50:ar=AJ(ap);as=ar[0];at=ar[1];if(!($interfaceIsEqual(at,$ifaceNil))){$s=52;continue;}$s=53;continue;case 52:$r=a.log(new BO([new $String("poll payload:"),at]));$s=54;case 54:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;case 53:al.Payload=I(as);case 48:av=a.handleEvent(al);$s=55;case 55:if($c){$c=false;av=av.$blk();}if(av&&av.$blk!==undefined){break s;}au=av;aw=au[0];ax=au[1];ak=au[3];if((g.$high>0||(g.$high===0&&g.$low>0))&&(g.$high<aw.$high||(g.$high===aw.$high&&g.$low<=aw.$low))){g=new $Int64(0,0);a.numSent=a.numSent+(1)>>0;}if(!ak){if(ax){d.$set(true);}$s=-1;return;}if(!d.$get()){$s=56;continue;}$s=57;continue;case 56:d.$set(true);$r=a.connState("connected");$s=58;case 58:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 57:ag++;$s=42;continue;case 43:$s=1;continue;case 2:$s=-1;return;}return;}if($f===undefined){$f={$blk:AP};}$f.a=a;$f.aa=aa;$f.ab=ab;$f.ac=ac;$f.ad=ad;$f.ae=ae;$f.af=af;$f.ag=ag;$f.ah=ah;$f.ai=ai;$f.aj=aj;$f.ak=ak;$f.al=al;$f.am=am;$f.an=an;$f.ao=ao;$f.ap=ap;$f.aq=aq;$f.ar=ar;$f.as=as;$f.at=at;$f.au=au;$f.av=av;$f.aw=aw;$f.ax=ax;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.v=v;$f.w=w;$f.x=x;$f.y=y;$f.z=z;$f.$s=$s;$f.$r=$r;return $f;};AQ=function(a,b){var a,b,c,d,e,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=$makeMap($String.keyFor,[{k:"action",v:new $String("ping")},{k:"session_id",v:a.sessionId}]);d=U(b,c,AH(new AX(0,7000),0.9));$s=1;case 1:if($c){$c=false;d=d.$blk();}if(d&&d.$blk!==undefined){break s;}e=d;$go(AS,[a,e,"ping error:"]);$s=-1;return;}return;}if($f===undefined){$f={$blk:AQ};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.$s=$s;$f.$r=$r;return $f;};AR=function(a,b){var a,b,c,d,e,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=$makeMap($String.keyFor,[{k:"action",v:new $String("close_session")},{k:"session_id",v:a.sessionId}]);d=U(b,c,AH(new AX(0,7000),0.9));$s=1;case 1:if($c){$c=false;d=d.$blk();}if(d&&d.$blk!==undefined){break s;}e=d;$go(AS,[a,e,"send error:"]);$s=-1;return;}return;}if($f===undefined){$f={$blk:AR};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.$s=$s;$f.$r=$r;return $f;};AS=function(a,b,c){var a,b,c,d,e,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:d=$recv(b);$s=1;case 1:if($c){$c=false;d=d.$blk();}if(d&&d.$blk!==undefined){break s;}e=$clone(d[0],AD);if(!($interfaceIsEqual(e.err,$ifaceNil))){$s=2;continue;}$s=3;continue;case 2:$r=a.log(new BO([new $String(c),e.err]));$s=4;case 4:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 3:$s=-1;return;}return;}if($f===undefined){$f={$blk:AS};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.$s=$s;$f.$r=$r;return $f;};AT=function(){return $parseFloat($global.Math.random());};AV.ptr.prototype.SetParams=function(a){var a,b,c,d,e,f,g;b=this;if($interfaceIsEqual((c=a[$String.keyFor("message_types")],c!==undefined?c.v:$ifaceNil),$ifaceNil)){$panic(new $String("message_types parameter not defined"));}d=(e=a[$String.keyFor("session_id")],e!==undefined?[e.v,true]:[$ifaceNil,false]);f=d[0];g=d[1];if(!($interfaceIsEqual(f,$ifaceNil))){b.sessionId=f;}else if(g){delete a[$String.keyFor("session_id")];}b.sessionParams=a;if(!(b.sendNotify===$chanNil)&&!b.running){b.running=true;$go($methodVal(b,"discover"),[]);}};AV.prototype.SetParams=function(a){return this.$val.SetParams(a);};AV.ptr.prototype.Open=function(){var a;a=this;if(a.closed){$panic(new $String("session already closed"));}if(!(a.sendNotify===$chanNil)){$panic(new $String("session already initialized"));}if(a.OnSessionEvent===$throwNilPointerError){$panic(new $String("onSessionEvent callback not defined"));}if(a.OnEvent===$throwNilPointerError){$panic(new $String("onEvent callback not defined"));}if(a.sessionParams===false){$panic(new $String("session parameters not defined"));}a.sendNotify=new $Chan(CA,1);a.closeNotify=new $Chan(CA,1);a.running=true;$go($methodVal(a,"discover"),[]);};AV.prototype.Open=function(){return this.$val.Open();};AV.ptr.prototype.Close=function(){var a,b,c,d,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:a=[a];a[0]=this;if(a[0].closed){$s=-1;return;}b=a[0].sendBuffer;c=0;case 1:if(!(c<b.$length)){$s=2;continue;}d=((c<0||c>=b.$length)?($throwRuntimeError("index out of range"),undefined):b.$array[b.$offset+c]);if(!(d.OnReply===$throwNilPointerError)){$s=3;continue;}$s=4;continue;case 3:$r=d.OnReply(BR.nil);$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 4:c++;$s=1;continue;case 2:a[0].sendBuffer=CC.nil;a[0].numSent=0;a[0].closed=true;a[0].running=false;$go((function(a){return function $b(){var $s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(a[0].closeNotify,$clone(new CA.ptr(),CA));$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$close(a[0].sendNotify);$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$r=$r;return $f;};})(a),[]);$s=-1;return;}return;}if($f===undefined){$f={$blk:AV.ptr.prototype.Close};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.$s=$s;$f.$r=$r;return $f;};AV.prototype.Close=function(){return this.$val.Close();};AV.ptr.prototype.Send=function(a){var a,b,c,d,e,f,g,h,i,j;b=$ifaceNil;c=this;if(c.sendNotify===$chanNil){$panic(new $String("session not initialized"));}if(c.closed){$panic(new $String("session already closed"));}if(a.Payload.$length===0){a.Payload=BQ.nil;}d=(e=a.Params[$String.keyFor("action_id")],e!==undefined?[e.v,true]:[$ifaceNil,false]);f=d[0];g=d[1];if(g&&$interfaceIsEqual(f,$ifaceNil)){delete a.Params[$String.keyFor("action_id")];}else{c.lastActionId=(h=c.lastActionId,i=new $Int64(0,1),new $Int64(h.$high+i.$high,h.$low+i.$low));a.id=c.lastActionId;j="action_id";(a.Params||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(j)]={k:j,v:a.id};}c.send(a);return b;};AV.prototype.Send=function(a){return this.$val.Send(a);};AV.ptr.prototype.send=function(a){var a,b;b=this;b.sendBuffer=$append(b.sendBuffer,a);$go((function $b(){var c,$r;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;c=$f.c;$r=$f.$r;}c=$select([[b.sendNotify,new CA.ptr()],[]]);if(c[0]===0){}else if(c[0]===1){}if($f===undefined){$f={$blk:$b};}$f.c=c;$f.$r=$r;return $f;}),[]);return;};AV.prototype.send=function(a){return this.$val.send(a);};AV.ptr.prototype.sendAck=function(){var a;a=this;a.sendEventAck=true;$go((function $b(){var b,$r;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;b=$f.b;$r=$f.$r;}b=$select([[a.sendNotify,new CA.ptr()],[]]);if(b[0]===0){}else if(b[0]===1){}if($f===undefined){$f={$blk:$b};}$f.b=b;$f.$r=$r;return $f;}),[]);};AV.prototype.sendAck=function(){return this.$val.sendAck();};AV.ptr.prototype.discover=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);a=[a];b=[b];b[0]=this;$deferred.push([(function(a,b){return function $b(){var $s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:if(b[0].closed&&!(b[0].OnClose===$throwNilPointerError)){$s=1;continue;}$s=2;continue;case 1:$r=b[0].OnClose();$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 2:$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$r=$r;return $f;};})(a,b),[]]);$r=b[0].log(new BO([new $String("opening")]));$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$deferred.push([$methodVal(b[0],"log"),[new BO([new $String("closed")])]]);$deferred.push([$methodVal(b[0],"connState"),["disconnected"]]);a[0]=new J.ptr(0);case 2:if(!(b[0].running)){$s=3;continue;}c=[c];$r=b[0].log(new BO([new $String("endpoint discovery")]));$s=4;case 4:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=b[0].connState("connecting");$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}d="https://"+D(b[0].Address)+"/v2/endpoint";e=AB(d);f=e[0];g=e[1];if(!($interfaceIsEqual(g,$ifaceNil))){$panic(g);}i=V(f,AH(new AX(0,7000),0.1));$s=6;case 6:if($c){$c=false;i=i.$blk();}if(i&&i.$blk!==undefined){break s;}j=$select([[i],[b[0].closeNotify]]);$s=7;case 7:if($c){$c=false;j=j.$blk();}if(j&&j.$blk!==undefined){break s;}h=j;if(h[0]===0){$s=8;continue;}if(h[0]===1){$s=9;continue;}$s=10;continue;case 8:k=$clone(h[1][0],AD);l=BN.nil;m=k.err;if($interfaceIsEqual(m,$ifaceNil)){c[0]=false;m=AL(k.data,(c.$ptr||(c.$ptr=new BU(function(){return this.$target[0];},function($v){this.$target[0]=$v;},c))));if($interfaceIsEqual(m,$ifaceNil)){n=E(c[0]);l=n[0];m=n[1];}}if($interfaceIsEqual(m,$ifaceNil)){$s=11;continue;}$s=12;continue;case 11:$r=b[0].log(new BO([new $String("endpoint discovered")]));$s=14;case 14:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}if(BF&&!b[0].forceLongPoll){$s=15;continue;}$s=16;continue;case 15:o=b[0].connect(BJ,l,a[0]);$s=19;case 19:if($c){$c=false;o=o.$blk();}if(o&&o.$blk!==undefined){break s;}if(o){$s=17;continue;}$s=18;continue;case 17:$s=2;continue;case 18:case 16:p=b[0].connect(AO,l,a[0]);$s=20;case 20:if($c){$c=false;p=p.$blk();}if(p&&p.$blk!==undefined){break s;}p;$s=13;continue;case 12:$r=b[0].log(new BO([new $String("endpoint discovery:"),m]));$s=21;case 21:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 13:$s=10;continue;case 9:$s=-1;return;case 10:q=b[0].backOff(a[0]);$s=24;case 24:if($c){$c=false;q=q.$blk();}if(q&&q.$blk!==undefined){break s;}if(!q){$s=22;continue;}$s=23;continue;case 22:$s=-1;return;case 23:$s=2;continue;case 3:$s=-1;return;}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:AV.ptr.prototype.discover};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};AV.prototype.discover=function(){return this.$val.discover();};AV.ptr.prototype.connect=function(a,b,c){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:d=false;e=this;f=0;case 1:if(!(f<2)){$s=2;continue;}g=b;h=0;case 3:if(!(h<g.$length)){$s=4;continue;}i=((h<0||h>=g.$length)?($throwRuntimeError("index out of range"),undefined):g.$array[g.$offset+h]);$r=e.connState("connecting");$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}j=e.Address;k=0;while(true){if(!(k<j.length)){break;}l=$decodeRune(j,k);m=k;n=l[0];if(n===47){i=i+($substring(e.Address,m));break;}k+=l[1];}p=a(e,i);$s=6;case 6:if($c){$c=false;p=p.$blk();}if(p&&p.$blk!==undefined){break s;}o=p;q=o[0];r=o[1];if(q){d=true;}if(r){c.success();$s=-1;return d;}if(!e.running){$s=-1;return d;}s=e.backOff(c);$s=9;case 9:if($c){$c=false;s=s.$blk();}if(s&&s.$blk!==undefined){break s;}if(!s){$s=7;continue;}$s=8;continue;case 7:$s=-1;return d;case 8:h++;$s=3;continue;case 4:f=f+(1)>>0;$s=1;continue;case 2:$s=-1;return d;}return;}if($f===undefined){$f={$blk:AV.ptr.prototype.connect};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.$s=$s;$f.$r=$r;return $f;};AV.prototype.connect=function(a,b,c){return this.$val.connect(a,b,c);};AV.ptr.prototype.backOff=function(a){var a,b,c,d,e,f,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=false;c=this;d=a.failure(new AX(0,60000));if((d.$high===0&&d.$low===0)){b=true;$s=-1;return b;}$r=c.log(new BO([new $String("sleeping")]));$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=c.connState("disconnected");$s=2;case 2:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}f=$select([[BD(d).C],[c.closeNotify]]);$s=3;case 3:if($c){$c=false;f=f.$blk();}if(f&&f.$blk!==undefined){break s;}e=f;if(e[0]===0){b=true;}else if(e[0]===1){}$s=-1;return b;}return;}if($f===undefined){$f={$blk:AV.ptr.prototype.backOff};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.$s=$s;$f.$r=$r;return $f;};AV.prototype.backOff=function(a){return this.$val.backOff(a);};AV.ptr.prototype.canLogin=function(){var a,b,c,d,e,f,g,h;a=this;if(!($interfaceIsEqual((b=a.sessionParams[$String.keyFor("access_key")],b!==undefined?b.v:$ifaceNil),$ifaceNil))){return true;}if(!($interfaceIsEqual((c=a.sessionParams[$String.keyFor("user_id")],c!==undefined?c.v:$ifaceNil),$ifaceNil))){return!($interfaceIsEqual((d=a.sessionParams[$String.keyFor("user_auth")],d!==undefined?d.v:$ifaceNil),$ifaceNil))||!($interfaceIsEqual((e=a.sessionParams[$String.keyFor("master_sign")],e!==undefined?e.v:$ifaceNil),$ifaceNil));}return!($interfaceIsEqual((f=a.sessionParams[$String.keyFor("identity_type")],f!==undefined?f.v:$ifaceNil),$ifaceNil))&&!($interfaceIsEqual((g=a.sessionParams[$String.keyFor("identity_name")],g!==undefined?g.v:$ifaceNil),$ifaceNil))&&!($interfaceIsEqual((h=a.sessionParams[$String.keyFor("identity_auth")],h!==undefined?h.v:$ifaceNil),$ifaceNil));};AV.prototype.canLogin=function(){return this.$val.canLogin();};AV.ptr.prototype.makeCreateSessionAction=function(){var a,aa,ab,ac,ad,ae,af,ag,ah,ai,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;a=false;b=this;a=$makeMap($String.keyFor,[{k:"action",v:new $String("create_session")}]);d=(c=b.sessionParams[$String.keyFor("user_id")],c!==undefined?c.v:$ifaceNil);if($interfaceIsEqual(d,$ifaceNil)){e=b.sessionParams;f=0;g=$keys(e);while(true){if(!(f<g.length)){break;}h=e[g[f]];if(h===undefined){f++;continue;}i=h.k;j=h.v;k=i;(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(k)]={k:k,v:j};f++;}}else{m=(l=b.sessionParams[$String.keyFor("user_auth")],l!==undefined?l.v:$ifaceNil);if(!($interfaceIsEqual(m,$ifaceNil))){n="user_id";(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(n)]={k:n,v:d};o="user_auth";(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(o)]={k:o,v:m};}else{q=(p=b.sessionParams[$String.keyFor("master_sign")],p!==undefined?p.v:$ifaceNil);if(!($interfaceIsEqual(q,$ifaceNil))){r="user_id";(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(r)]={k:r,v:d};s="master_sign";(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(s)]={k:s,v:q};}else{u=(t=b.sessionParams[$String.keyFor("identity_type")],t!==undefined?t.v:$ifaceNil);if(!($interfaceIsEqual(u,$ifaceNil))){v="identity_type";(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(v)]={k:v,v:u};w="identity_name";(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(w)]={k:w,v:(x=b.sessionParams[$String.keyFor("identity_name")],x!==undefined?x.v:$ifaceNil)};y="identity_auth";(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(y)]={k:y,v:(z=b.sessionParams[$String.keyFor("identity_auth")],z!==undefined?z.v:$ifaceNil)};}else{aa="user_id";(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(aa)]={k:aa,v:d};}}}ab=b.sessionParams;ac=0;ad=$keys(ab);while(true){if(!(ac<ad.length)){break;}ae=ab[ad[ac]];if(ae===undefined){ac++;continue;}af=ae.k;ag=ae.v;ah=af;if(ah===("user_id")||ah===("user_auth")||ah===("identity_type")||ah===("identity_name")||ah===("identity_auth")||ah===("access_key")||ah===("master_sign")){}else{ai=af;(a||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(ai)]={k:ai,v:ag};}ac++;}}return a;};AV.prototype.makeCreateSessionAction=function(){return this.$val.makeCreateSessionAction();};AV.ptr.prototype.makeResumeSessionAction=function(a){var a,b,c,d;b=false;c=this;b=$makeMap($String.keyFor,[{k:"action",v:new $String("resume_session")},{k:"event_id",v:c.receivedEventId}]);if(a){d="session_id";(b||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(d)]={k:d,v:c.sessionId};}c.sendEventAck=false;c.ackedEventId=c.receivedEventId;return b;};AV.prototype.makeResumeSessionAction=function(a){return this.$val.makeResumeSessionAction(a);};AV.ptr.prototype.handleSessionEvent=function(a){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=false;c=this;d=new G.ptr(a,BQ.nil,false);e=false;if(d.String()==="error"){c.sessionId=$ifaceNil;e=true;f=d.Str("error_type");g=f[0];h=g;if(h===("internal")){}else{c.running=false;}}$r=c.OnSessionEvent(d);$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}if(e){$s=-1;return b;}delete c.sessionParams[$String.keyFor("user_attrs")];delete c.sessionParams[$String.keyFor("user_settings")];delete c.sessionParams[$String.keyFor("identity_attrs")];delete c.sessionParams[$String.keyFor("access_key")];delete c.sessionParams[$String.keyFor("master_sign")];i="user_id";(c.sessionParams||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(i)]={k:i,v:(j=d.Params[$String.keyFor("user_id")],j!==undefined?j.v:$ifaceNil)};l=(k=d.Params[$String.keyFor("user_auth")],k!==undefined?k.v:$ifaceNil);if(!($interfaceIsEqual(l,$ifaceNil))){m="user_auth";(c.sessionParams||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(m)]={k:m,v:l};}n=new BN(["identity_type","identity_name","identity_auth"]);o=0;while(true){if(!(o<n.$length)){break;}p=((o<0||o>=n.$length)?($throwRuntimeError("index out of range"),undefined):n.$array[n.$offset+o]);r=(q=c.sessionParams[$String.keyFor(p+"_new")],q!==undefined?q.v:$ifaceNil);if(!($interfaceIsEqual(r,$ifaceNil))){delete c.sessionParams[$String.keyFor(p+"_new")];s=p;(c.sessionParams||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(s)]={k:s,v:r};}o++;}c.sessionId=(t=d.Params[$String.keyFor("session_id")],t!==undefined?t.v:$ifaceNil);if(c.sendBuffer.$length===0){c.lastActionId=new $Int64(0,0);}c.sendEventAck=false;u=d.Int64("event_id");c.receivedEventId=u[0];c.ackedEventId=new $Int64(0,0);$r=c.log(new BO([new $String("session created")]));$s=2;case 2:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}b=true;$s=-1;return b;}return;}if($f===undefined){$f={$blk:AV.ptr.prototype.handleSessionEvent};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.$s=$s;$f.$r=$r;return $f;};AV.prototype.handleSessionEvent=function(a){return this.$val.handleSessionEvent(a);};AV.ptr.prototype.handleEvent=function(a){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=[b];c=[c];b[0]=new $Int64(0,0);d=false;e=false;f=false;c[0]=this;g=a.Int64("event_id");h=g[0];if((h.$high>0||(h.$high===0&&h.$low>0))){c[0].receivedEventId=h;if(!c[0].sendEventAck){if((i=(j=c[0].receivedEventId,k=c[0].ackedEventId,new $Int64(j.$high-k.$high,j.$low-k.$low)),(i.$high>AU.$high||(i.$high===AU.$high&&i.$low>=AU.$low)))){c[0].sendAck();}else{e=true;}}}l=a.Int64("action_id");b[0]=l[0];if((b[0].$high>0||(b[0].$high===0&&b[0].$low>0))){$s=1;continue;}$s=2;continue;case 1:m=C.Search(c[0].numSent,(function(b,c){return function(m){var m,n,o,p;o=(n=c[0].sendBuffer,((m<0||m>=n.$length)?($throwRuntimeError("index out of range"),undefined):n.$array[n.$offset+m]));return(p=o.id,(p.$high>b[0].$high||(p.$high===b[0].$high&&p.$low>=b[0].$low)));};})(b,c));$s=3;case 3:if($c){$c=false;m=m.$blk();}if(m&&m.$blk!==undefined){break s;}n=m;if(n<c[0].numSent){$s=4;continue;}$s=5;continue;case 4:p=(o=c[0].sendBuffer,((n<0||n>=o.$length)?($throwRuntimeError("index out of range"),undefined):o.$array[o.$offset+n]));if((q=p.id,(q.$high===b[0].$high&&q.$low===b[0].$low))){$s=6;continue;}$s=7;continue;case 6:a.initLastReply(p);if(!(p.OnReply===$throwNilPointerError)){$s=8;continue;}$s=9;continue;case 8:$r=p.OnReply(a);$s=10;case 10:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 9:if(a.LastReply){c[0].sendBuffer=$appendSlice($subslice(c[0].sendBuffer,0,n),$subslice(c[0].sendBuffer,(n+1>>0)));c[0].numSent=c[0].numSent-(1)>>0;}case 7:case 5:case 2:if(a.String()==="user_deleted"){$s=11;continue;}$s=12;continue;case 11:c[0].sessionId=$ifaceNil;c[0].running=false;$r=c[0].OnSessionEvent(a);$s=13;case 13:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}d=true;$s=-1;return[b[0],d,e,f];case 12:r=a.getError();s=r[0];t=r[1];d=r[2];u=r[3];if(!($interfaceIsEqual(u,$ifaceNil))){$s=14;continue;}$s=15;continue;case 14:$r=c[0].log(new BO([new $String("event:"),u]));$s=16;case 16:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}if(d){$s=17;continue;}$s=18;continue;case 17:c[0].sessionId=$ifaceNil;if(!c[0].canLogin()){$s=19;continue;}$s=20;continue;case 19:c[0].running=false;$r=c[0].OnSessionEvent(a);$s=21;case 21:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 20:case 18:$s=-1;return[b[0],d,e,f];case 15:if(s==="deprecated"){$s=22;continue;}$s=23;continue;case 22:$r=c[0].log(new BO([new $String("deprecated:"),new $String(t)]));$s=24;case 24:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 23:$r=c[0].OnEvent(a);$s=25;case 25:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}f=true;$s=-1;return[b[0],d,e,f];}return;}if($f===undefined){$f={$blk:AV.ptr.prototype.handleEvent};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.$s=$s;$f.$r=$r;return $f;};AV.prototype.handleEvent=function(a){return this.$val.handleEvent(a);};AV.ptr.prototype.connState=function(a){var a,b,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;if(!(b.latestConnState===a)){$s=1;continue;}$s=2;continue;case 1:b.latestConnState=a;if(!(b.OnConnState===$throwNilPointerError)){$s=3;continue;}$s=4;continue;case 3:$r=b.OnConnState(b.latestConnState);$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 4:case 2:$s=-1;return;}return;}if($f===undefined){$f={$blk:AV.ptr.prototype.connState};}$f.a=a;$f.b=b;$f.$s=$s;$f.$r=$r;return $f;};AV.prototype.connState=function(a){return this.$val.connState(a);};AV.ptr.prototype.connActive=function(){var a,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:a=this;if(!(a.OnConnActive===$throwNilPointerError)){$s=1;continue;}$s=2;continue;case 1:$r=a.OnConnActive();$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 2:$s=-1;return;}return;}if($f===undefined){$f={$blk:AV.ptr.prototype.connActive};}$f.a=a;$f.$s=$s;$f.$r=$r;return $f;};AV.prototype.connActive=function(){return this.$val.connActive();};AV.ptr.prototype.log=function(a){var a,b,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;if(!(b.OnLog===$throwNilPointerError)){$s=1;continue;}$s=2;continue;case 1:$r=b.OnLog(a);$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 2:$s=-1;return;}return;}if($f===undefined){$f={$blk:AV.ptr.prototype.log};}$f.a=a;$f.b=b;$f.$s=$s;$f.$r=$r;return $f;};AV.prototype.log=function(a){return this.$val.log(a);};AZ=function(){var a;return((a=$internalize(new($global.Date)().getTime(),$Int64),new AY(a.$high,a.$low)));};BA=function(a,b){var a,b,c;return(c=(new AY(b.$high,b.$low)),new AY(a.$high+c.$high,a.$low+c.$low));};BB=function(a,b){var a,b,c;return((c=new AY(a.$high-b.$high,a.$low-b.$low),new AX(c.$high,c.$low)));};BD=function(a){var a,b;b=CD.nil;b=new BC.ptr(new $Chan(CA,0),null);if((a.$high>0||(a.$high===0&&a.$low>=0))){b.Reset(a);}return b;};BC.ptr.prototype.Active=function(){var a;a=this;return!(a.id===null);};BC.prototype.Active=function(){return this.$val.Active();};BC.ptr.prototype.Reset=function(a){var a,b;b=this;b.Stop();b.id=$global.setTimeout($externalize((function(){b.id=null;$go((function $b(){var $s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(b.C,$clone(new CA.ptr(),CA));$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$r=$r;return $f;}),[]);}),BX),$externalize(a,AX));};BC.prototype.Reset=function(a){return this.$val.Reset(a);};BC.ptr.prototype.Stop=function(){var a;a=this;if(!(a.id===null)){$global.clearTimeout(a.id);a.id=null;}};BC.prototype.Stop=function(){return this.$val.Stop();};BG=function(){BE=$global.WebSocket;if(BE===undefined){BE=$module.require($externalize("ws",$String));}BF=!(BE===undefined)&&!(BE.CLOSING===undefined);};BI=function(a,b){var a,b,c,d,e,f,g;c=CE.nil;c=new BH.ptr(new $Chan(CA,1),false,$ifaceNil,new(BE)($externalize(a,$String)),false,CF.nil);c.impl.binaryType=$externalize("arraybuffer",$String);d=false;e=(function(){if(!d){d=true;$go((function(){$close(c.notify);}),[]);}});f=$global.setTimeout($externalize((function $b(){var $s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c.err=A.New("timeout");$r=e();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$r=$r;return $f;}),BX),$externalize(b,AX));g=(function(){if(!(f===null)){$global.clearTimeout(f);f=null;}});c.impl.onopen=$externalize((function $b(h){var h,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;h=$f.h;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=g();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}if(!($interfaceIsEqual(c.err,$ifaceNil))){c.impl.close();$s=-1;return;}c.open=true;$go((function $b(){var $s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:if(!d){$s=1;continue;}$s=2;continue;case 1:$r=$send(c.notify,$clone(new CA.ptr(),CA));$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 2:$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$r=$r;return $f;}),[]);$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.h=h;$f.$s=$s;$f.$r=$r;return $f;}),CG);c.impl.onmessage=$externalize((function(h){var h;c.buf=$append(c.buf,h.data);$go((function $b(){var i,$r;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;i=$f.i;$r=$f.$r;}if(!d){i=$select([[c.notify,new CA.ptr()],[]]);if(i[0]===0){}else if(i[0]===1){}}if($f===undefined){$f={$blk:$b};}$f.i=i;$f.$r=$r;return $f;}),[]);}),CG);c.impl.onclose=$externalize((function $b(h){var h,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;h=$f.h;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c.goingAway=(($parseInt(h.code)>>0)===1001);c.open=false;$r=e();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.h=h;$f.$s=$s;$f.$r=$r;return $f;}),CG);c.impl.onerror=$externalize((function $b(h){var h,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;h=$f.h;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=g();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}if($interfaceIsEqual(c.err,$ifaceNil)){c.err=A.New($internalize(h.message,$String));}$r=e();$s=2;case 2:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.h=h;$f.$s=$s;$f.$r=$r;return $f;}),CG);return c;};BH.ptr.prototype.send=function(a){var a,b,c,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b=$ifaceNil;c=this;$deferred.push([(function(){b=S($recover());}),[]]);c.impl.send(a);return b;}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return b;}}};BH.prototype.send=function(a){return this.$val.send(a);};BH.ptr.prototype.sendJSON=function(a){var a,b,c,d,e;b=$ifaceNil;c=this;d=AJ(a);e=d[0];b=d[1];if(!($interfaceIsEqual(b,$ifaceNil))){return b;}b=c.send(e);return b;};BH.prototype.sendJSON=function(a){return this.$val.sendJSON(a);};BH.ptr.prototype.sendPayload=function(a){var a,b,c,d,e,f,g,h,i,j,k,l,m,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b=$ifaceNil;c=this;$deferred.push([(function(){b=S($recover());}),[]]);d=a.String()==="update_user";e=a.Payload;f=0;while(true){if(!(f<e.$length)){break;}g=((f<0||f>=e.$length)?($throwRuntimeError("index out of range"),undefined):e.$array[e.$offset+f]);h=g;if(d){i=h.split($externalize(",",$String))[1];j=$global.atob(i);k=$parseInt(j.length);h=new($global.ArrayBuffer)(k);l=new($global.Uint8Array)(h);m=0;while(true){if(!(m<k)){break;}l[m]=j.charCodeAt(m);m=m+(1)>>0;}}c.impl.send(h);f++;}return b;}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return b;}}};BH.prototype.sendPayload=function(a){return this.$val.sendPayload(a);};BH.ptr.prototype.receive=function(){var a,b,c;a=null;b=this;if(b.buf.$length>0){a=(c=b.buf,(0>=c.$length?($throwRuntimeError("index out of range"),undefined):c.$array[c.$offset+0]));b.buf=$subslice(b.buf,1);}return a;};BH.prototype.receive=function(){return this.$val.receive();};BH.ptr.prototype.receiveJSON=function(){var a,b,c,d,e;a=false;b=$ifaceNil;c=this;d=c.receive();if(d===null){return[a,b];}b=AL(P(d),(e||(e=new BU(function(){return a;},function($v){a=$v;}))));return[a,b];};BH.prototype.receiveJSON=function(){return this.$val.receiveJSON();};BH.ptr.prototype.close=function(){var a,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);a=this;$deferred.push([(function(){$recover();}),[]]);a.impl.close();}catch(err){$err=err;}finally{$callDeferred($deferred,$err);}};BH.prototype.close=function(){return this.$val.close();};BJ=function(a,b){var a,b,c,d,e,f,g,h,i,j,k,l,m,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);c=[c];d=false;e=false;c[0]=CE.nil;$deferred.push([(function(c){return function(){if(!(c[0]===CE.nil)){c[0].close();}};})(c),[]]);case 1:e=false;f=false;$r=a.log(new BO([new $String("connecting to"),new $String(b)]));$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}c[0]=BI("wss://"+b+"/v2/socket",AH(new AX(0,9000),0.1));h=$select([[c[0].notify],[a.closeNotify]]);$s=4;case 4:if($c){$c=false;h=h.$blk();}if(h&&h.$blk!==undefined){break s;}g=h;if(g[0]===0){$s=5;continue;}if(g[0]===1){$s=6;continue;}$s=7;continue;case 5:i=g[1];j=i[1];if(j){$s=8;continue;}if(!($interfaceIsEqual(c[0].err,$ifaceNil))){$s=9;continue;}$s=10;continue;case 8:$r=a.log(new BO([new $String("connected")]));$s=12;case 12:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=a.connState("connected");$s=13;case 13:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}d=true;l=BK(a,c[0]);$s=14;case 14:if($c){$c=false;l=l.$blk();}if(l&&l.$blk!==undefined){break s;}k=l;e=k[0];f=k[1];$s=11;continue;case 9:$r=a.log(new BO([new $String("connection failed:"),c[0].err]));$s=15;case 15:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=11;continue;case 10:$r=a.log(new BO([new $String("connection failed")]));$s=16;case 16:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 11:$s=7;continue;case 6:case 7:m=c[0].goingAway;c[0].close();c[0]=CE.nil;if(m){$s=17;continue;}$s=18;continue;case 17:$r=a.log(new BO([new $String("disconnected (server is going away)")]));$s=20;case 20:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=19;continue;case 18:$r=a.log(new BO([new $String("disconnected")]));$s=21;case 21:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 19:if(!e||!f||!a.running||m){$s=-1;return[d,e];}$s=1;continue;case 2:$s=-1;return[d,e];}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[d,e];}if($curGoroutine.asleep){if($f===undefined){$f={$blk:BJ};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};BK=function(a,b){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=false;d=false;e=false;if($interfaceIsEqual(a.sessionId,$ifaceNil)){$s=1;continue;}$s=2;continue;case 1:$r=a.log(new BO([new $String("session creation")]));$s=4;case 4:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}e=a.makeCreateSessionAction();$s=3;continue;case 2:$r=a.log(new BO([new $String("session resumption")]));$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}e=a.makeResumeSessionAction(true);case 3:f=b.sendJSON(e);if(!($interfaceIsEqual(f,$ifaceNil))){$s=6;continue;}$s=7;continue;case 6:$r=a.log(new BO([new $String("send:"),f]));$s=8;case 8:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 7:if($interfaceIsEqual(a.sessionId,$ifaceNil)){$s=9;continue;}$s=10;continue;case 9:g=false;h=true;i=BD(AH(new AX(0,13000),0.2));case 11:j=$ifaceNil;k=b.receiveJSON();g=k[0];j=k[1];if(!($interfaceIsEqual(j,$ifaceNil))){$s=13;continue;}$s=14;continue;case 13:$r=a.log(new BO([new $String("session creation:"),j]));$s=15;case 15:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return[c,d];case 14:if(!(g===false)){i.Stop();$s=12;continue;}if(!h){$s=16;continue;}$s=17;continue;case 16:$r=a.log(new BO([new $String("disconnected during session creation:"),b.err]));$s=18;case 18:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}i.Stop();$s=-1;return[c,d];case 17:m=$select([[b.notify],[i.C]]);$s=19;case 19:if($c){$c=false;m=m.$blk();}if(m&&m.$blk!==undefined){break s;}l=m;if(l[0]===0){$s=20;continue;}if(l[0]===1){$s=21;continue;}$s=22;continue;case 20:n=l[1];h=n[1];$s=22;continue;case 21:$r=a.log(new BO([new $String("session creation timeout")]));$s=23;case 23:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return[c,d];case 22:$s=11;continue;case 12:o=a.handleSessionEvent(g);$s=26;case 26:if($c){$c=false;o=o.$blk();}if(o&&o.$blk!==undefined){break s;}if(!o){$s=24;continue;}$s=25;continue;case 24:$s=-1;return[c,d];case 25:c=true;d=true;$r=a.connActive();$s=27;case 27:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 10:p=new $Chan(CA,1);q=new $Chan(CA,0);$go(BL,[a,b,p,q]);s=BM(a,b,p);$s=28;case 28:if($c){$c=false;s=s.$blk();}if(s&&s.$blk!==undefined){break s;}r=s;t=r[0];d=r[1];if(t){c=true;}u=$recv(q);$s=29;case 29:if($c){$c=false;u=u.$blk();}if(u&&u.$blk!==undefined){break s;}u[0];$s=-1;return[c,d];}return;}if($f===undefined){$f={$blk:BK};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.$s=$s;$f.$r=$r;return $f;};BL=function(a,b,c,d){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;v=$f.v;w=$f.w;x=$f.x;y=$f.y;z=$f.z;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);d=[d];$deferred.push([(function(d){return function $b(){var $s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(d[0],$clone(new CA.ptr(),CA));$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$r=$r;return $f;};})(d),[]]);e=BD(AH(new AX(0,56000),-0.3));$deferred.push([$methodVal(e,"Stop"),[]]);a.numSent=0;case 1:case 3:if(!(a.numSent<a.sendBuffer.$length)){$s=4;continue;}h=(f=a.sendBuffer,g=a.numSent,((g<0||g>=f.$length)?($throwRuntimeError("index out of range"),undefined):f.$array[f.$offset+g]));if(!(h.Payload===BQ.nil)){i="frames";(h.Params||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(i)]={k:i,v:new $Int(h.Payload.$length)};}if(!((j=a.receivedEventId,k=a.ackedEventId,(j.$high===k.$high&&j.$low===k.$low)))){l="event_id";(h.Params||$throwRuntimeError("assignment to entry in nil map"))[$String.keyFor(l)]={k:l,v:a.receivedEventId};a.sendEventAck=false;a.ackedEventId=a.receivedEventId;}m=b.sendJSON(h.Params);delete h.Params[$String.keyFor("frames")];delete h.Params[$String.keyFor("event_id")];if(!($interfaceIsEqual(m,$ifaceNil))){$s=5;continue;}$s=6;continue;case 5:$r=a.log(new BO([new $String("send:"),m]));$s=7;case 7:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,$clone(new CA.ptr(),CA));$s=8;case 8:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;case 6:if(!(h.Payload===BQ.nil)){$s=9;continue;}$s=10;continue;case 9:n=b.sendPayload(h);if(!($interfaceIsEqual(n,$ifaceNil))){$s=11;continue;}$s=12;continue;case 11:$r=a.log(new BO([new $String("send:"),n]));$s=13;case 13:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,$clone(new CA.ptr(),CA));$s=14;case 14:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;case 12:case 10:if((o=h.id,(o.$high===0&&o.$low===0))){a.sendBuffer=$appendSlice($subslice(a.sendBuffer,0,a.numSent),$subslice(a.sendBuffer,(a.numSent+1>>0)));}else{a.numSent=a.numSent+(1)>>0;}e.Reset(AH(new AX(0,56000),-0.3));$s=3;continue;case 4:if(a.sendEventAck&&!((p=a.receivedEventId,q=a.ackedEventId,(p.$high===q.$high&&p.$low===q.$low)))){$s=15;continue;}$s=16;continue;case 15:r=a.makeResumeSessionAction(false);s=b.sendJSON(r);if(!($interfaceIsEqual(s,$ifaceNil))){$s=17;continue;}$s=18;continue;case 17:$r=a.log(new BO([new $String("send:"),s]));$s=19;case 19:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,$clone(new CA.ptr(),CA));$s=20;case 20:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;case 18:case 16:u=$select([[a.sendNotify],[e.C],[c]]);$s=21;case 21:if($c){$c=false;u=u.$blk();}if(u&&u.$blk!==undefined){break s;}t=u;if(t[0]===0){$s=22;continue;}if(t[0]===1){$s=23;continue;}if(t[0]===2){$s=24;continue;}$s=25;continue;case 22:v=t[1];w=v[1];if(!w){$s=26;continue;}$s=27;continue;case 26:x=$makeMap($String.keyFor,[{k:"action",v:new $String("close_session")}]);y=b.sendJSON(x);if(!($interfaceIsEqual(y,$ifaceNil))){$s=28;continue;}$s=29;continue;case 28:$r=a.log(new BO([new $String("send:"),y]));$s=30;case 30:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 29:$s=-1;return;case 27:$s=25;continue;case 23:z=b.send(N());if(!($interfaceIsEqual(z,$ifaceNil))){$s=31;continue;}$s=32;continue;case 31:$r=a.log(new BO([new $String("send:"),z]));$s=33;case 33:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,$clone(new CA.ptr(),CA));$s=34;case 34:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;case 32:e.Reset(AH(new AX(0,56000),-0.3));$s=25;continue;case 24:$s=-1;return;case 25:$s=1;continue;case 2:$s=-1;return;}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:BL};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.v=v;$f.w=w;$f.x=x;$f.y=y;$f.z=z;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};BM=function(a,b,c){var a,aa,ab,ac,ad,ae,af,ag,ah,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;aa=$f.aa;ab=$f.ab;ac=$f.ac;ad=$f.ad;ae=$f.ae;af=$f.af;ag=$f.ag;ah=$f.ah;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;v=$f.v;w=$f.w;x=$f.x;y=$f.y;z=$f.z;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);d=false;e=false;f=b.notify;g=true;h=BR.nil;i=0;j=AH(new AX(0,64000),0.3);k=BA(AZ(),j);l=BD(j);$deferred.push([$methodVal(l,"Stop"),[]]);m=BD(new AX(-1,4294967295));$deferred.push([$methodVal(m,"Stop"),[]]);case 1:n=false;case 3:o=[o];if(h===BR.nil){$s=5;continue;}$s=6;continue;case 5:p=b.receive();if(p===null){$s=4;continue;}q=AH(new AX(0,64000),0.7);k=BA(AZ(),q);if(!l.Active()){l.Reset(q);}$r=a.connActive();$s=8;case 8:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}r=P(p);if(O(r)===0){$s=9;continue;}$s=10;continue;case 9:$s=3;continue;case 10:o[0]=false;s=AL(r,(o.$ptr||(o.$ptr=new BU(function(){return this.$target[0];},function($v){this.$target[0]=$v;},o))));if(!($interfaceIsEqual(s,$ifaceNil))){$s=11;continue;}$s=12;continue;case 11:$r=a.log(new BO([new $String("receive:"),s]));$s=13;case 13:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}e=false;$r=$send(c,$clone(new CA.ptr(),CA));$s=14;case 14:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return[d,e];case 12:h=new G.ptr(o[0],BQ.nil,false);t=h.Int("frames");u=t[0];if(u>0){i=u;}$s=7;continue;case 6:v=b.receive();if(v===null){if(!g){h=BR.nil;i=0;}$s=4;continue;}h.Payload=$append(h.Payload,v);i=i-(1)>>0;case 7:if(i===0){$s=15;continue;}$s=16;continue;case 15:x=a.handleEvent(h);$s=17;case 17:if($c){$c=false;x=x.$blk();}if(x&&x.$blk!==undefined){break s;}w=x;y=w[1];z=w[2];aa=w[3];if(!aa){$s=18;continue;}$s=19;continue;case 18:if(y){d=true;}else{e=false;}$r=$send(c,$clone(new CA.ptr(),CA));$s=20;case 20:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return[d,e];case 19:if(z){n=true;}h=BR.nil;i=0;d=true;e=true;case 16:ab=$select([[a.closeNotify],[c],[]]);if(ab[0]===0){$s=-1;return[d,e];}else if(ab[0]===1){$s=-1;return[d,e];}else if(ab[0]===2){}$s=3;continue;case 4:if(!g&&h===BR.nil){$s=21;continue;}$s=22;continue;case 21:if(!($interfaceIsEqual(b.err,$ifaceNil))){$s=23;continue;}$s=24;continue;case 23:$r=a.log(new BO([new $String("receive:"),b.err]));$s=26;case 26:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=25;continue;case 24:$r=a.log(new BO([new $String("receive disconnect")]));$s=27;case 27:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 25:$r=$send(c,$clone(new CA.ptr(),CA));$s=28;case 28:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return[d,e];case 22:if(n&&!m.Active()){m.Reset(AH(new AX(0,7000),-0.3));}ad=$select([[f],[l.C],[m.C],[a.closeNotify],[c]]);$s=29;case 29:if($c){$c=false;ad=ad.$blk();}if(ad&&ad.$blk!==undefined){break s;}ac=ad;if(ac[0]===0){$s=30;continue;}if(ac[0]===1){$s=31;continue;}if(ac[0]===2){$s=32;continue;}if(ac[0]===3){$s=33;continue;}if(ac[0]===4){$s=34;continue;}$s=35;continue;case 30:ae=ac[1];g=ae[1];if(!g){f=$chanNil;}$s=35;continue;case 31:af=BB(k,AZ());if((af.$high>0||(af.$high===0&&af.$low>16))){$s=36;continue;}$s=37;continue;case 36:l.Reset(af);$s=38;continue;case 37:$r=a.log(new BO([new $String("receive timeout")]));$s=39;case 39:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,$clone(new CA.ptr(),CA));$s=40;case 40:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return[d,e];case 38:$s=35;continue;case 32:if(!a.sendEventAck&&!((ag=a.ackedEventId,ah=a.receivedEventId,(ag.$high===ah.$high&&ag.$low===ah.$low)))){a.sendAck();}$s=35;continue;case 33:$s=-1;return[d,e];case 34:$s=-1;return[d,e];case 35:$s=1;continue;case 2:$s=-1;return[d,e];}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[d,e];}if($curGoroutine.asleep){if($f===undefined){$f={$blk:BM};}$f.a=a;$f.aa=aa;$f.ab=ab;$f.ac=ac;$f.ad=ad;$f.ae=ae;$f.af=af;$f.ag=ag;$f.ah=ah;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.v=v;$f.w=w;$f.x=x;$f.y=y;$f.z=z;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};CB.methods=[{prop:"String",name:"String",pkg:"",typ:$funcType([],[$String],false)}];BR.methods=[{prop:"Bool",name:"Bool",pkg:"",typ:$funcType([$String],[$Bool],false)},{prop:"Int",name:"Int",pkg:"",typ:$funcType([$String],[$Int,$Bool],false)},{prop:"Int64",name:"Int64",pkg:"",typ:$funcType([$String],[$Int64,$Bool],false)},{prop:"Float64",name:"Float64",pkg:"",typ:$funcType([$String],[$Float64,$Bool],false)},{prop:"Str",name:"Str",pkg:"",typ:$funcType([$String],[$String,$Bool],false)},{prop:"Array",name:"Array",pkg:"",typ:$funcType([$String],[BO,$Bool],false)},{prop:"Map",name:"Map",pkg:"",typ:$funcType([$String],[BP,$Bool],false)},{prop:"String",name:"String",pkg:"",typ:$funcType([],[$String],false)},{prop:"initLastReply",name:"initLastReply",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([CB],[],false)},{prop:"getError",name:"getError",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[$String,$String,$Bool,$error],false)}];CI.methods=[{prop:"success",name:"success",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[],false)},{prop:"failure",name:"failure",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([AX],[AX],false)}];CJ.methods=[{prop:"Call",name:"Call",pkg:"",typ:$funcType([CB],[BS,$error],false)}];Z.methods=[{prop:"Set",name:"Set",pkg:"",typ:$funcType([$String,$String],[],false)}];CK.methods=[{prop:"SetParams",name:"SetParams",pkg:"",typ:$funcType([BP],[],false)},{prop:"Open",name:"Open",pkg:"",typ:$funcType([],[],false)},{prop:"Close",name:"Close",pkg:"",typ:$funcType([],[],false)},{prop:"Send",name:"Send",pkg:"",typ:$funcType([CB],[$error],false)},{prop:"send",name:"send",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([CB],[],false)},{prop:"sendAck",name:"sendAck",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[],false)},{prop:"discover",name:"discover",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[],false)},{prop:"connect",name:"connect",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([AW,BN,CI],[$Bool],false)},{prop:"backOff",name:"backOff",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([CI],[$Bool],false)},{prop:"canLogin",name:"canLogin",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[$Bool],false)},{prop:"makeCreateSessionAction",name:"makeCreateSessionAction",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[BP],false)},{prop:"makeResumeSessionAction",name:"makeResumeSessionAction",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([$Bool],[BP],false)},{prop:"handleSessionEvent",name:"handleSessionEvent",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([BP],[$Bool],false)},{prop:"handleEvent",name:"handleEvent",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([BR],[$Int64,$Bool,$Bool,$Bool],false)},{prop:"connState",name:"connState",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([$String],[],false)},{prop:"connActive",name:"connActive",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[],false)},{prop:"log",name:"log",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([BO],[],true)}];CD.methods=[{prop:"Active",name:"Active",pkg:"",typ:$funcType([],[$Bool],false)},{prop:"Reset",name:"Reset",pkg:"",typ:$funcType([AX],[],false)},{prop:"Stop",name:"Stop",pkg:"",typ:$funcType([],[],false)}];CE.methods=[{prop:"send",name:"send",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([BY],[$error],false)},{prop:"sendJSON",name:"sendJSON",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([BP],[$error],false)},{prop:"sendPayload",name:"sendPayload",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([CB],[$error],false)},{prop:"receive",name:"receive",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[BY],false)},{prop:"receiveJSON",name:"receiveJSON",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[BP,$error],false)},{prop:"close",name:"close",pkg:"github.com/ninchat/ninchat-go",typ:$funcType([],[],false)}];F.init("github.com/ninchat/ninchat-go",[{prop:"Params",name:"Params",anonymous:false,exported:true,typ:BP,tag:""},{prop:"Payload",name:"Payload",anonymous:false,exported:true,typ:BQ,tag:""},{prop:"OnReply",name:"OnReply",anonymous:false,exported:true,typ:CH,tag:""},{prop:"id",name:"id",anonymous:false,exported:false,typ:$Int64,tag:""}]);G.init("",[{prop:"Params",name:"Params",anonymous:false,exported:true,typ:BP,tag:""},{prop:"Payload",name:"Payload",anonymous:false,exported:true,typ:BQ,tag:""},{prop:"LastReply",name:"LastReply",anonymous:false,exported:true,typ:$Bool,tag:""}]);H.init(B.Object);J.init("github.com/ninchat/ninchat-go",[{prop:"lastSlot",name:"lastSlot",anonymous:false,exported:false,typ:$Int,tag:""}]);M.init("",[{prop:"Address",name:"Address",anonymous:false,exported:true,typ:$String,tag:""}]);Z.init($String,$String);AA.init("github.com/ninchat/ninchat-go",[{prop:"Method",name:"Method",anonymous:false,exported:true,typ:$String,tag:""},{prop:"URL",name:"URL",anonymous:false,exported:true,typ:$String,tag:""},{prop:"Header",name:"Header",anonymous:false,exported:true,typ:Z,tag:""},{prop:"data",name:"data",anonymous:false,exported:false,typ:BY,tag:""}]);AD.init("github.com/ninchat/ninchat-go",[{prop:"data",name:"data",anonymous:false,exported:false,typ:BY,tag:""},{prop:"err",name:"err",anonymous:false,exported:false,typ:$error,tag:""}]);AV.init("github.com/ninchat/ninchat-go",[{prop:"OnSessionEvent",name:"OnSessionEvent",anonymous:false,exported:true,typ:CH,tag:""},{prop:"OnEvent",name:"OnEvent",anonymous:false,exported:true,typ:CH,tag:""},{prop:"OnClose",name:"OnClose",anonymous:false,exported:true,typ:BX,tag:""},{prop:"OnConnState",name:"OnConnState",anonymous:false,exported:true,typ:CL,tag:""},{prop:"OnConnActive",name:"OnConnActive",anonymous:false,exported:true,typ:BX,tag:""},{prop:"OnLog",name:"OnLog",anonymous:false,exported:true,typ:CM,tag:""},{prop:"Address",name:"Address",anonymous:false,exported:true,typ:$String,tag:""},{prop:"forceLongPoll",name:"forceLongPoll",anonymous:false,exported:false,typ:$Bool,tag:""},{prop:"sessionParams",name:"sessionParams",anonymous:false,exported:false,typ:BP,tag:""},{prop:"sessionId",name:"sessionId",anonymous:false,exported:false,typ:$emptyInterface,tag:""},{prop:"latestConnState",name:"latestConnState",anonymous:false,exported:false,typ:$String,tag:""},{prop:"lastActionId",name:"lastActionId",anonymous:false,exported:false,typ:$Int64,tag:""},{prop:"sendNotify",name:"sendNotify",anonymous:false,exported:false,typ:CN,tag:""},{prop:"sendBuffer",name:"sendBuffer",anonymous:false,exported:false,typ:CC,tag:""},{prop:"numSent",name:"numSent",anonymous:false,exported:false,typ:$Int,tag:""},{prop:"sendEventAck",name:"sendEventAck",anonymous:false,exported:false,typ:$Bool,tag:""},{prop:"receivedEventId",name:"receivedEventId",anonymous:false,exported:false,typ:$Int64,tag:""},{prop:"ackedEventId",name:"ackedEventId",anonymous:false,exported:false,typ:$Int64,tag:""},{prop:"closeNotify",name:"closeNotify",anonymous:false,exported:false,typ:CN,tag:""},{prop:"closed",name:"closed",anonymous:false,exported:false,typ:$Bool,tag:""},{prop:"running",name:"running",anonymous:false,exported:false,typ:$Bool,tag:""}]);AW.init([CK,$String],[$Bool,$Bool],false);BC.init("github.com/ninchat/ninchat-go",[{prop:"C",name:"C",anonymous:false,exported:true,typ:CN,tag:""},{prop:"id",name:"id",anonymous:false,exported:false,typ:BY,tag:""}]);BH.init("github.com/ninchat/ninchat-go",[{prop:"notify",name:"notify",anonymous:false,exported:false,typ:CN,tag:""},{prop:"goingAway",name:"goingAway",anonymous:false,exported:false,typ:$Bool,tag:""},{prop:"err",name:"err",anonymous:false,exported:false,typ:$error,tag:""},{prop:"impl",name:"impl",anonymous:false,exported:false,typ:BY,tag:""},{prop:"open",name:"open",anonymous:false,exported:false,typ:$Bool,tag:""},{prop:"buf",name:"buf",anonymous:false,exported:false,typ:CF,tag:""}]);$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=A.$init();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=B.$init();$s=2;case 2:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=C.$init();$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}W=null;X=false;BE=null;BF=false;AU=AI(new $Int64(0,4096),-0.25);Y();BG();}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["ninchatclient/lib"]=(function(){var $pkg={},$init,A,B,H,I,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,AA,AB,AC,AD,AE,AF,AG,AH,C,D,E,F,G,J,K,L;A=$packages["github.com/gopherjs/gopherjs/js"];B=$packages["github.com/ninchat/ninchat-go"];H=$pkg.Promise=$newType(0,$kindStruct,"clientlib.Promise",true,"ninchatclient/lib",true,function(OnPanic_,fulfillers_,rejecters_,notifiers_){this.$val=this;if(arguments.length===0){this.OnPanic=$throwNilPointerError;this.fulfillers=N.nil;this.rejecters=N.nil;this.notifiers=N.nil;return;}this.OnPanic=OnPanic_;this.fulfillers=fulfillers_;this.rejecters=rejecters_;this.notifiers=notifiers_;});I=$pkg.SessionAdapter=$newType(0,$kindStruct,"clientlib.SessionAdapter",true,"ninchatclient/lib",true,function(Session_,OnPanic_){this.$val=this;if(arguments.length===0){this.Session=X.nil;this.OnPanic=$throwNilPointerError;return;}this.Session=Session_;this.OnPanic=OnPanic_;});M=$ptrType(A.Object);N=$sliceType(M);O=$sliceType(B.Frame);P=$mapType($String,$emptyInterface);Q=$sliceType(P);R=$sliceType($emptyInterface);S=$funcType([P,M,M],[M],false);T=$funcType([],[P],false);U=$funcType([M],[M],false);V=$funcType([M,M,M],[M],false);W=$ptrType(B.Event);X=$ptrType(B.Session);Y=$ptrType(B.Action);Z=$sliceType(Y);AA=$funcType([M],[],false);AB=$funcType([P],[],false);AC=$funcType([$String],[],false);AD=$funcType([],[],false);AE=$funcType([P,M],[M],false);AF=$ptrType(H);AG=$funcType([$String,$emptyInterface],[],false);AH=$ptrType(I);C=function(a,b,c){var a,b,c,d,e;d="";if(!(c===undefined)){d=$internalize(c,$String);}e=new H.ptr(E((function(){return(function(e){var e;if(!(b===undefined)){b($externalize(e,$String));}});})),N.nil,N.nil,N.nil);$go((function $b(){var f,g,h,i,j,k,l,m,n,o,p,q,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:f=new B.Caller.ptr(d);g=new B.Action.ptr(a,O.nil,$throwNilPointerError,new $Int64(0,0));i=f.Call(g);$s=1;case 1:if($c){$c=false;i=i.$blk();}if(i&&i.$blk!==undefined){break s;}h=i;j=h[0];k=h[1];if(!($interfaceIsEqual(k,$ifaceNil))){$s=2;continue;}$s=3;continue;case 2:l=k.Error();$s=4;case 4:if($c){$c=false;l=l.$blk();}if(l&&l.$blk!==undefined){break s;}m=l;if(!(b===undefined)){b($externalize(m,$String));}$r=e.OnReply(new B.Event.ptr($makeMap($String.keyFor,[{k:"event",v:new $String("error")},{k:"error_type",v:new $String("internal")},{k:"error_reason",v:new $String(m)}]),O.nil,false));$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;case 3:n=Q.nil;o=j;p=0;while(true){if(!(p<o.$length)){break;}q=((p<0||p>=o.$length)?($throwRuntimeError("index out of range"),undefined):o.$array[o.$offset+p]);n=$append(n,q.Params);p++;}$r=e.Resolve(new R([n]));$s=6;case 6:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.$s=$s;$f.$r=$r;return $f;}),[]);return e.Object();};D=function(a){var a;a.call=$externalize(C,S);a.newSession=$externalize(K,T);a.stringifyFrame=$externalize(B.StringifyFrame,U);};$pkg.Init=D;E=function(a){var a;return(function $b(b,c){var b,c,d,e,f,g,h,i,j,k,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:if(!($interfaceIsEqual(c,$ifaceNil))){$s=1;continue;}$s=2;continue;case 1:d=a();$s=3;case 3:if($c){$c=false;d=d.$blk();}if(d&&d.$blk!==undefined){break s;}e=d;if(!(e===$throwNilPointerError)){$s=4;continue;}$s=5;continue;case 4:f="";g=c;if($assertType(g,$String,true)[1]){$s=6;continue;}if($assertType(g,$error,true)[1]){$s=7;continue;}$s=8;continue;case 6:h=g.$val;f=h;$s=9;continue;case 7:i=g;k=i.Error();$s=10;case 10:if($c){$c=false;k=k.$blk();}if(k&&k.$blk!==undefined){break s;}f=k;$s=9;continue;case 8:j=g;f=$internalize($global.JSON.stringify($externalize(j,$emptyInterface)),$String);case 9:$r=e(b+" "+f);$s=11;case 11:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 5:case 2:$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.$s=$s;$f.$r=$r;return $f;});};$pkg.Panicer=E;F=function(a){var a,b,c;b=O.nil;if(!(a===null)&&!(a===undefined)){c=0;while(true){if(!(c<$parseInt(a.length))){break;}b=$append(b,a[c]);c=c+(1)>>0;}}return b;};$pkg.WrapPayload=F;G=function(a){var a,b,c,d,e;b=N.nil;c=a;d=0;while(true){if(!(d<c.$length)){break;}e=((d<0||d>=c.$length)?($throwRuntimeError("index out of range"),undefined):c.$array[c.$offset+d]);b=$append(b,e);d++;}return b;};$pkg.UnwrapPayload=G;H.ptr.prototype.Object=function(){var a,b;a=null;b=this;a=new($global.Object)();a.then=$externalize((function(c,d,e){var c,d,e;if(!(c===null)&&!(c===undefined)){b.fulfillers=$append(b.fulfillers,c);}if(!(d===null)&&!(d===undefined)){b.rejecters=$append(b.rejecters,d);}if(!(e===null)&&!(e===undefined)){b.notifiers=$append(b.notifiers,e);}return a;}),V);return a;};H.prototype.Object=function(){return this.$val.Object();};H.ptr.prototype.OnReply=function(a){var a,b,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;if(!(a===W.nil)){$s=1;continue;}$s=2;continue;case 1:if(a.String()==="error"){$s=3;continue;}if(a.LastReply){$s=4;continue;}$s=5;continue;case 3:$r=b.Reject(new R([new P(a.Params)]));$s=7;case 7:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=6;continue;case 4:$r=b.Resolve(new R([new P(a.Params),G(a.Payload)]));$s=8;case 8:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=6;continue;case 5:$r=b.Notify(new R([new P(a.Params),G(a.Payload)]));$s=9;case 9:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 6:case 2:$s=-1;return;}return;}if($f===undefined){$f={$blk:H.ptr.prototype.OnReply};}$f.a=a;$f.b=b;$f.$s=$s;$f.$r=$r;return $f;};H.prototype.OnReply=function(a){return this.$val.OnReply(a);};H.ptr.prototype.Resolve=function(a){var a,b,c,d,e,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;c=b.fulfillers;d=0;case 1:if(!(d<c.$length)){$s=2;continue;}e=((d<0||d>=c.$length)?($throwRuntimeError("index out of range"),undefined):c.$array[c.$offset+d]);$r=b.invoke("Promise onFulfilled callback:",e,a);$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}d++;$s=1;continue;case 2:$s=-1;return;}return;}if($f===undefined){$f={$blk:H.ptr.prototype.Resolve};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.$s=$s;$f.$r=$r;return $f;};H.prototype.Resolve=function(a){return this.$val.Resolve(a);};H.ptr.prototype.Reject=function(a){var a,b,c,d,e,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;c=b.rejecters;d=0;case 1:if(!(d<c.$length)){$s=2;continue;}e=((d<0||d>=c.$length)?($throwRuntimeError("index out of range"),undefined):c.$array[c.$offset+d]);$r=b.invoke("Promise onRejected callback:",e,a);$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}d++;$s=1;continue;case 2:$s=-1;return;}return;}if($f===undefined){$f={$blk:H.ptr.prototype.Reject};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.$s=$s;$f.$r=$r;return $f;};H.prototype.Reject=function(a){return this.$val.Reject(a);};H.ptr.prototype.Notify=function(a){var a,b,c,d,e,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;c=b.notifiers;d=0;case 1:if(!(d<c.$length)){$s=2;continue;}e=((d<0||d>=c.$length)?($throwRuntimeError("index out of range"),undefined):c.$array[c.$offset+d]);$r=b.invoke("Promise onNotified callback:",e,a);$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}d++;$s=1;continue;case 2:$s=-1;return;}return;}if($f===undefined){$f={$blk:H.ptr.prototype.Notify};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.$s=$s;$f.$r=$r;return $f;};H.prototype.Notify=function(a){return this.$val.Notify(a);};H.ptr.prototype.invoke=function(a,b,c){var a,b,c,d,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);a=[a];d=[d];d[0]=this;$deferred.push([(function(a,d){return function $b(){var $s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=d[0].OnPanic(a[0],$recover());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$r=$r;return $f;};})(a,d),[]]);b.apply(undefined,$externalize(c,R));$s=-1;return;}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:H.ptr.prototype.invoke};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};H.prototype.invoke=function(a,b,c){return this.$val.invoke(a,b,c);};J=function(a){var a;return new I.ptr(a,E((function(){return(function $b(b){var b,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;b=$f.b;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:if(!(a.OnLog===$throwNilPointerError)){$s=1;continue;}$s=2;continue;case 1:$r=a.OnLog(new R([new $String(b)]));$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 2:$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.b=b;$f.$s=$s;$f.$r=$r;return $f;});})));};$pkg.NewSessionAdapter=J;I.ptr.prototype.InvokeOnSessionEvent=function(a,b,c){var a,b,c,d,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);a=[a];d=[d];d[0]=this;$deferred.push([(function(a,d){return function $b(){var $s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=d[0].OnPanic(a[0],$recover());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$r=$r;return $f;};})(a,d),[]]);b($externalize(c.Params,P));$s=-1;return;}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:I.ptr.prototype.InvokeOnSessionEvent};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};I.prototype.InvokeOnSessionEvent=function(a,b,c){return this.$val.InvokeOnSessionEvent(a,b,c);};I.ptr.prototype.OnSessionEvent=function(a){var a,b;b=this;b.Session.OnSessionEvent=(function $b(c){var c,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;c=$f.c;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=b.InvokeOnSessionEvent("Session.onSessionEvent callback:",a,c);$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.c=c;$f.$s=$s;$f.$r=$r;return $f;});};I.prototype.OnSessionEvent=function(a){return this.$val.OnSessionEvent(a);};I.ptr.prototype.InvokeOnEvent=function(a,b,c){var a,b,c,d,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);a=[a];d=[d];d[0]=this;$deferred.push([(function(a,d){return function $b(){var $s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=d[0].OnPanic(a[0],$recover());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$r=$r;return $f;};})(a,d),[]]);b($externalize(c.Params,P),$externalize(G(c.Payload),N));$s=-1;return;}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:I.ptr.prototype.InvokeOnEvent};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};I.prototype.InvokeOnEvent=function(a,b,c){return this.$val.InvokeOnEvent(a,b,c);};I.ptr.prototype.OnEvent=function(a){var a,b;b=this;b.Session.OnEvent=(function $b(c){var c,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;c=$f.c;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=b.InvokeOnEvent("Session.onEvent callback:",a,c);$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.c=c;$f.$s=$s;$f.$r=$r;return $f;});};I.prototype.OnEvent=function(a){return this.$val.OnEvent(a);};I.ptr.prototype.OnClose=function(a){var a,b;b=this;b.Session.OnClose=(function $b(){var $s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);$deferred.push([(function $b(){var $s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=b.OnPanic("Session.onClose callback:",$recover());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$r=$r;return $f;}),[]]);a();$s=-1;return;}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}});};I.prototype.OnClose=function(a){return this.$val.OnClose(a);};I.ptr.prototype.OnConnState=function(a){var a,b;b=this;if(a===null){b.Session.OnConnState=$throwNilPointerError;return;}b.Session.OnConnState=(function $b(c){var c,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;c=$f.c;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);$deferred.push([(function $b(){var $s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=b.OnPanic("Session.onConnState callback:",$recover());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$r=$r;return $f;}),[]]);a($externalize(c,$String));$s=-1;return;}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:$b};}$f.c=c;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}});};I.prototype.OnConnState=function(a){return this.$val.OnConnState(a);};I.ptr.prototype.OnConnActive=function(a){var a,b;b=this;if(a===null){b.Session.OnConnActive=$throwNilPointerError;return;}b.Session.OnConnActive=(function $b(){var $s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);$deferred.push([(function $b(){var $s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=b.OnPanic("Session.onConnActive callback:",$recover());$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;return;}return;}if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$r=$r;return $f;}),[]]);a(new($global.Date)().getTime());$s=-1;return;}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:$b};}$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}});};I.prototype.OnConnActive=function(a){return this.$val.OnConnActive(a);};I.ptr.prototype.OnLog=function(a){var a,b;b=this;if(a===null){b.Session.OnLog=$throwNilPointerError;return;}b.Session.OnLog=(function $b(c){var c,d,e,f,g,h,i,j,k,l,m,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);$deferred.push([(function(){$recover();}),[]]);d="";e=c;f=0;case 1:if(!(f<e.$length)){$s=2;continue;}g=((f<0||f>=e.$length)?($throwRuntimeError("index out of range"),undefined):e.$array[e.$offset+f]);h="";i=g;if($assertType(i,$String,true)[1]){$s=3;continue;}if($assertType(i,$error,true)[1]){$s=4;continue;}$s=5;continue;case 3:j=i.$val;h=j;$s=6;continue;case 4:k=i;m=k.Error();$s=7;case 7:if($c){$c=false;m=m.$blk();}if(m&&m.$blk!==undefined){break s;}h=m;$s=6;continue;case 5:l=i;h=$internalize($global.JSON.stringify($externalize(l,$emptyInterface)),$String);case 6:if(d.length>0){d=d+(" ");}d=d+(h);f++;$s=1;continue;case 2:while(true){if(!(d.length>0&&(d.charCodeAt((d.length-1>>0))===32))){break;}d=$substring(d,0,(d.length-1>>0));}a($externalize(d,$String));$s=-1;return;}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:$b};}$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}});};I.prototype.OnLog=function(a){return this.$val.OnLog(a);};I.ptr.prototype.SetAddress=function(a){var a,b;b=this;b.Session.Address=a;};I.prototype.SetAddress=function(a){return this.$val.SetAddress(a);};I.ptr.prototype.Send=function(a,b){var a,b,c,d,e,f,g,h,i,j,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=null;d=this;e=new B.Action.ptr(a,F(b),$throwNilPointerError,new $Int64(0,0));f=(g=a[$String.keyFor("action_id")],g!==undefined?[g.v,true]:[$ifaceNil,false]);h=f[1];if(!h){i=new H.ptr(d.OnPanic,N.nil,N.nil,N.nil);e.OnReply=$methodVal(i,"OnReply");c=i.Object();}j=d.Session.Send(e);$s=1;case 1:if($c){$c=false;j=j.$blk();}if(j&&j.$blk!==undefined){break s;}j;$s=-1;return c;}return;}if($f===undefined){$f={$blk:I.ptr.prototype.Send};}$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.$s=$s;$f.$r=$r;return $f;};I.prototype.Send=function(a,b){return this.$val.Send(a,b);};K=function(){var a,b;a=new B.Session.ptr($throwNilPointerError,$throwNilPointerError,$throwNilPointerError,$throwNilPointerError,$throwNilPointerError,$throwNilPointerError,"",false,new $packages["sync"].Mutex.ptr(0,0),false,$ifaceNil,"",new $Int64(0,0),$chanNil,Z.nil,0,false,new $Int64(0,0),new $Int64(0,0),$chanNil,false,false);b=J(a);return $makeMap($String.keyFor,[{k:"onSessionEvent",v:new AA($methodVal(b,"OnSessionEvent"))},{k:"onEvent",v:new AA($methodVal(b,"OnEvent"))},{k:"onClose",v:new AA($methodVal(b,"OnClose"))},{k:"onConnState",v:new AA($methodVal(b,"OnConnState"))},{k:"onConnActive",v:new AA($methodVal(b,"OnConnActive"))},{k:"onLog",v:new AA($methodVal(b,"OnLog"))},{k:"setParams",v:new AB($methodVal(a,"SetParams"))},{k:"setTransport",v:new AC(L)},{k:"setAddress",v:new AC($methodVal(b,"SetAddress"))},{k:"open",v:new AD($methodVal(a,"Open"))},{k:"close",v:new AD($methodVal(a,"Close"))},{k:"send",v:new AE($methodVal(b,"Send"))}]);};L=function(a){var a;console.log("NinchatClient.Session.setTransport doesn't do anything anymore");};AF.methods=[{prop:"Object",name:"Object",pkg:"",typ:$funcType([],[M],false)},{prop:"OnReply",name:"OnReply",pkg:"",typ:$funcType([W],[],false)},{prop:"Resolve",name:"Resolve",pkg:"",typ:$funcType([R],[],true)},{prop:"Reject",name:"Reject",pkg:"",typ:$funcType([R],[],true)},{prop:"Notify",name:"Notify",pkg:"",typ:$funcType([R],[],true)},{prop:"invoke",name:"invoke",pkg:"ninchatclient/lib",typ:$funcType([$String,M,R],[],true)}];AH.methods=[{prop:"InvokeOnSessionEvent",name:"InvokeOnSessionEvent",pkg:"",typ:$funcType([$String,M,W],[],false)},{prop:"OnSessionEvent",name:"OnSessionEvent",pkg:"",typ:$funcType([M],[],false)},{prop:"InvokeOnEvent",name:"InvokeOnEvent",pkg:"",typ:$funcType([$String,M,W],[],false)},{prop:"OnEvent",name:"OnEvent",pkg:"",typ:$funcType([M],[],false)},{prop:"OnClose",name:"OnClose",pkg:"",typ:$funcType([M],[],false)},{prop:"OnConnState",name:"OnConnState",pkg:"",typ:$funcType([M],[],false)},{prop:"OnConnActive",name:"OnConnActive",pkg:"",typ:$funcType([M],[],false)},{prop:"OnLog",name:"OnLog",pkg:"",typ:$funcType([M],[],false)},{prop:"SetAddress",name:"SetAddress",pkg:"",typ:$funcType([$String],[],false)},{prop:"Send",name:"Send",pkg:"",typ:$funcType([P,M],[M],false)}];H.init("ninchatclient/lib",[{prop:"OnPanic",name:"OnPanic",anonymous:false,exported:true,typ:AG,tag:""},{prop:"fulfillers",name:"fulfillers",anonymous:false,exported:false,typ:N,tag:""},{prop:"rejecters",name:"rejecters",anonymous:false,exported:false,typ:N,tag:""},{prop:"notifiers",name:"notifiers",anonymous:false,exported:false,typ:N,tag:""}]);I.init("",[{prop:"Session",name:"Session",anonymous:false,exported:true,typ:X,tag:""},{prop:"OnPanic",name:"OnPanic",anonymous:false,exported:true,typ:AG,tag:""}]);$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=A.$init();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=B.$init();$s=2;case 2:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["ninchatclient"]=(function(){var $pkg={},$init,A,C,B,D;A=$packages["github.com/gopherjs/gopherjs/js"];C=$packages["github.com/ninchat/ninchat-go"];B=$packages["ninchatclient/lib"];D=function(){var a;a=undefined;if(!($module===undefined)){a=$module.exports;}if(a===undefined){a=new($global.Object)();$global.NinchatClient=a;}B.Init(a);};$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=A.$init();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=C.$init();$s=2;case 2:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=B.$init();$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}if($pkg===$mainPkg){D();$mainFinished=true;}}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$synthesizeMethods();
var $mainPkg = $packages["ninchatclient"];
$packages["runtime"].$init();
$go($mainPkg.$init, []);
$flushConsole();

}).call(this);
//# sourceMappingURL=ninchatclient.min.js.map
